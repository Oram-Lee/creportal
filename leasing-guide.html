<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>임대안내문 관리 - CRE PORTAL</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/guide-preview-styles.css?v=5.0">
    <style>
        /* ===== CSS 변수 ===== */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-card: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --accent-color: #3b82f6;
            --accent-hover: #2563eb;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --bg-card: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --border-color: #334155;
        }

        /* ===== 기본 리셋 ===== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* ===== 헤더 ===== */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            height: 56px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-color);
            text-decoration: none;
        }
        .header-title {
            font-size: 14px;
            color: var(--text-secondary);
        }
        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .back-btn {
            color: var(--accent-color);
            text-decoration: none;
            font-size: 13px;
        }
        .back-btn:hover { text-decoration: underline; }
        .theme-btn {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            padding: 4px;
        }
        .user-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }
        .user-badge .role {
            background: var(--accent-color);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        /* ===== 버튼 ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }
        .btn-primary {
            background: var(--accent-color);
            color: white;
        }
        .btn-primary:hover { background: var(--accent-hover); }
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        .btn-secondary:hover { background: var(--border-color); }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        .btn-lg { padding: 12px 24px; font-size: 15px; }

        /* ===== 리스트 컨테이너 ===== */
        .list-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 24px;
        }
        .main-container { }
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }
        .page-header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .page-header .subtitle {
            color: var(--text-muted);
            font-size: 14px;
        }

        /* ===== 필터 바 ===== */
        .filter-bar {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
            align-items: center;
            padding: 16px;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
        }
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .filter-group label {
            font-size: 13px;
            color: var(--text-muted);
        }
        .filter-group select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 13px;
        }

        /* ===== 가이드 리스트 ===== */
        .guide-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .guide-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
        }
        .guide-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        .guide-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .guide-meta {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: var(--text-muted);
        }
        .guide-meta span { display: flex; align-items: center; gap: 4px; }
        .guide-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .guide-status.draft { background: #fef3c7; color: #92400e; }
        .guide-status.published { background: #d1fae5; color: #065f46; }
        .guide-status.closed { background: #fee2e2; color: #991b1b; }
        .guide-info {
            display: flex;
            gap: 24px;
            margin-bottom: 16px;
            font-size: 14px;
        }
        .guide-info-item .label { color: var(--text-muted); font-size: 12px; }
        .guide-info-item .value { font-weight: 600; margin-top: 2px; }
        .guide-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* 액션 버튼 스타일 */
        .action-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 8px 14px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .action-btn:hover {
            background: var(--bg-secondary);
            border-color: var(--text-muted);
        }
        .action-btn.primary {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        .action-btn.primary:hover {
            background: var(--accent-hover);
            border-color: var(--accent-hover);
        }
        .action-btn.danger {
            background: #fef2f2;
            color: #dc2626;
            border-color: #fecaca;
        }
        .action-btn.danger:hover {
            background: #fee2e2;
            border-color: #fca5a5;
        }
        [data-theme="dark"] .action-btn.danger {
            background: #450a0a;
            color: #fca5a5;
            border-color: #7f1d1d;
        }

        /* ===== 에디터 ===== */
        .edit-container {
            display: none;
            height: calc(100vh - 56px);
        }
        .edit-container.active { display: flex; flex-direction: column; }
        .edit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
        }
        .edit-header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .edit-title-input {
            font-size: 16px;
            font-weight: 600;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            width: 280px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .edit-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
            color: var(--text-muted);
        }
        .status-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }
        .status-badge.draft { background: #fef3c7; color: #92400e; }
        .status-badge.published { background: #d1fae5; color: #065f46; }

        .edit-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        .edit-sidebar {
            width: 280px;
            background: var(--bg-card);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }
        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        .sidebar-header h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .sidebar-actions {
            display: flex;
            gap: 8px;
        }
        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }
        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-secondary);
        }
        .summary-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }
        .summary-label {
            color: var(--text-muted);
        }
        .summary-value {
            font-weight: 600;
            color: var(--text-primary);
        }
        .summary-regions {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 8px;
        }
        .summary-item {
            background: var(--bg-card);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
        }
        .summary-item .region { font-weight: 600; }
        .summary-item .count { color: var(--accent-color); }

        .toc-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            margin-bottom: 4px;
            background: var(--bg-secondary);
            transition: all 0.15s;
        }
        .toc-item:hover { background: var(--bg-tertiary); }
        .toc-item.active { background: var(--accent-color); color: white; }
        .toc-item .drag-handle { 
            cursor: grab; 
            color: var(--text-muted); 
            font-size: 10px;
            letter-spacing: -2px;
        }
        .toc-item.active .drag-handle { color: rgba(255,255,255,0.6); }
        .toc-item .item-icon { font-size: 14px; }
        .toc-item .item-name { 
            flex: 1; 
            overflow: hidden; 
            text-overflow: ellipsis; 
            white-space: nowrap;
            font-weight: 500;
        }
        .toc-item .item-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }
        .toc-item.active .item-badge {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        .toc-item .close-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #fbbf24;
        }
        .toc-item .close-dot.confirmed {
            background: #22c55e;
        }
        .toc-item.active .close-dot {
            box-shadow: 0 0 0 2px rgba(255,255,255,0.3);
        }
        
        /* TOC 권역 구분 */
        .toc-region {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            padding: 12px 12px 6px;
            display: flex;
            align-items: center;
            gap: 6px;
            border-top: 1px solid var(--border-color);
            margin-top: 8px;
        }
        .toc-region:first-of-type {
            border-top: none;
            margin-top: 0;
        }
        .toc-region span {
            font-weight: 400;
            color: var(--text-muted);
            opacity: 0.7;
        }
        
        /* TOC 표지 아이템 */
        .toc-item.cover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-bottom: 12px;
        }
        .toc-item.cover:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        .toc-item.cover .item-icon { font-size: 16px; }

        .toc-item .region-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            background: var(--bg-tertiary);
        }
        .toc-item.divider {
            background: var(--bg-tertiary);
            font-style: italic;
            color: var(--text-muted);
        }

        /* ===== TOC 드래그앤드롭 ===== */
        .toc-item {
            position: relative;
        }
        .toc-item.dragging {
            opacity: 0.5;
            background: var(--accent-light);
        }
        .toc-item.drag-over {
            border-top: 2px solid var(--accent-color);
        }
        .toc-item .delete-btn {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 22px;
            height: 22px;
            border-radius: 4px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
        }
        .toc-item:hover .delete-btn {
            display: flex;
        }
        .toc-item .delete-btn:hover {
            background: #fee2e2;
            color: #dc2626;
        }
        .toc-item.cover .delete-btn { display: none !important; }

        /* ===== v4.9: TOC 개편 스타일 ===== */
        
        /* 표지 스타일 */
        .toc-item.toc-cover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-bottom: 8px;
        }
        .toc-item.toc-cover:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        
        /* 자동 생성 페이지 (전체목차) */
        .toc-item.toc-auto {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px dashed #38bdf8;
            color: #0369a1;
        }
        .toc-item.toc-auto:hover {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
        }
        .toc-item.toc-auto.active {
            background: #0ea5e9;
            color: white;
            border-color: #0ea5e9;
        }
        .toc-item .auto-badge {
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 3px;
            background: #38bdf8;
            color: white;
        }
        .toc-item.toc-auto.active .auto-badge {
            background: rgba(255,255,255,0.3);
        }
        
        /* 권역 그룹 */
        .toc-region-group {
            margin-top: 8px;
            border-left: 3px solid var(--border-color);
            margin-left: 4px;
        }
        
        /* 권역 헤더 (목차) */
        .toc-item.toc-region-header {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 1px dashed #86efac;
            color: #166534;
            margin-left: -3px;
            border-left: 3px solid #22c55e;
        }
        .toc-item.toc-region-header:hover {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
        }
        .toc-item.toc-region-header.active {
            background: #22c55e;
            color: white;
            border-color: #22c55e;
        }
        .toc-item .count-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            background: #22c55e;
            color: white;
            min-width: 20px;
            text-align: center;
        }
        .toc-item.toc-region-header.active .count-badge {
            background: rgba(255,255,255,0.3);
        }
        
        /* 권역 아이템들 (빌딩, 간지) */
        .toc-region-items {
            padding-left: 8px;
        }
        .toc-region-items .toc-item {
            margin-left: 0;
            font-size: 12px;
            padding: 8px 10px;
        }
        .toc-region-items .toc-item .item-icon {
            font-size: 12px;
        }
        
        /* 빌딩 아이템 */
        .toc-item.toc-building {
            background: var(--bg-secondary);
        }
        .toc-item.toc-building:hover {
            background: var(--bg-tertiary);
        }
        .toc-item.toc-building.active {
            background: var(--accent-color);
            color: white;
        }
        .toc-item.toc-building.confirmed {
            border-left: 3px solid #22c55e;
        }
        
        /* 간지 아이템 */
        .toc-item.toc-divider {
            background: var(--bg-tertiary);
            font-style: italic;
            color: var(--text-muted);
        }
        .toc-item.toc-divider.active {
            background: #6b7280;
            color: white;
        }
        
        /* 엔딩 아이템 */
        .toc-item.toc-ending {
            background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
            border: 1px dashed #e879f9;
            color: #86198f;
            margin-top: 8px;
        }
        .toc-item.toc-ending:hover {
            background: linear-gradient(135deg, #fae8ff 0%, #f5d0fe 100%);
        }
        .toc-item.toc-ending.active {
            background: #d946ef;
            color: white;
            border-color: #d946ef;
        }
        
        /* 플로팅 네비게이션 버튼 */
        .floating-nav-buttons {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-tertiary);
            padding: 4px 8px;
            border-radius: 6px;
        }
        .floating-nav-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            background: var(--accent-color);
            color: white;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s;
        }
        .floating-nav-btn:hover {
            background: var(--accent-hover);
        }
        .floating-page-info {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            min-width: 50px;
            text-align: center;
        }
        
        /* 목차 미리보기 컨테이너 */
        .toc-preview-container {
            padding: 20px;
        }
        .toc-preview-header {
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }
        .toc-preview-header .preview-badge {
            display: inline-block;
            font-size: 12px;
            padding: 4px 10px;
            background: #0ea5e9;
            color: white;
            border-radius: 4px;
            margin-bottom: 8px;
        }
        .toc-preview-header h2 {
            font-size: 18px;
            margin-bottom: 4px;
        }
        .toc-preview-header p {
            font-size: 13px;
            color: var(--text-muted);
        }
        
        /* 목차 미리보기 페이지 */
        .toc-preview-page {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            overflow: hidden;
            aspect-ratio: 297 / 210;
            max-width: 100%;
        }
        
        /* 전체 목차 페이지 스타일 */
        .fullpreview-toc-full {
            padding: 30px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .toc-full-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        .toc-full-logo img {
            height: 40px;
        }
        .toc-full-logo span {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-color);
        }
        .toc-full-title h1 {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
        }
        .toc-full-title p {
            font-size: 14px;
            color: #6b7280;
        }
        .toc-full-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            flex: 1;
        }
        .toc-full-region {
            background: #f9fafb;
            border-radius: 8px;
            padding: 16px;
        }
        .toc-region-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e5e7eb;
        }
        .toc-region-title .region-name {
            flex: 1;
            font-weight: 600;
            color: #374151;
        }
        .toc-region-title .region-count {
            font-size: 12px;
            color: #6b7280;
        }
        .toc-region-buildings {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .toc-building-name {
            font-size: 13px;
            color: #4b5563;
            padding: 4px 0;
            border-bottom: 1px dotted #e5e7eb;
        }
        .toc-more {
            font-size: 12px;
            color: #9ca3af;
            font-style: italic;
        }
        
        /* 권역별 목차 페이지 스타일 */
        .fullpreview-toc-region {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .toc-region-header-banner {
            padding: 30px;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        .toc-region-header-banner.region-GBD {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }
        .toc-region-header-banner.region-YBD {
            background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
        }
        .toc-region-header-banner.region-CBD {
            background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
        }
        .toc-region-header-banner.region-BBD {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .toc-region-header-banner.region-PAN {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .toc-region-header-banner.region-ETC {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }
        .toc-region-logo img {
            height: 40px;
        }
        .toc-region-logo span {
            font-size: 24px;
            font-weight: 700;
        }
        .toc-region-info {
            display: flex;
            align-items: baseline;
            gap: 12px;
        }
        .toc-region-info .region-code {
            font-size: 36px;
            font-weight: 700;
        }
        .toc-region-info .region-full-name {
            font-size: 20px;
        }
        .toc-region-info .region-building-count {
            font-size: 14px;
            opacity: 0.8;
        }
        .toc-region-list {
            flex: 1;
            padding: 20px 30px;
            overflow-y: auto;
        }
        .toc-region-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        .toc-region-item .item-num {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent-color);
            min-width: 30px;
        }
        .toc-region-item .item-name {
            flex: 1;
            font-weight: 500;
            color: #1f2937;
        }
        .toc-region-item .item-address {
            font-size: 12px;
            color: #6b7280;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* ===== 빌딩 프리뷰 레이아웃 (가로형 A4 임대안내문 스타일) ===== */
        .building-preview {
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.15);
            overflow: hidden;
            aspect-ratio: 297 / 210; /* A4 가로 비율 */
            max-width: 100%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            font-family: 'Noto Sans KR', -apple-system, sans-serif;
        }
        
        /* 헤더 (빌딩명) */
        .building-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 20px;
            background: white;
            border-bottom: 3px solid #1e3a5f;
        }
        .building-preview-header .building-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .building-preview-header .building-icon {
            font-size: 22px;
        }
        .building-preview-header .building-name {
            font-size: 24px;
            font-weight: 700;
            color: #1e3a5f;
        }
        .building-preview-header .exclusive-badge {
            padding: 4px 12px;
            background: #fef3c7;
            color: #92400e;
            font-size: 13px;
            font-weight: 600;
            border-radius: 4px;
        }
        .building-preview-header .region-info {
            font-size: 16px;
            color: #1e3a5f;
            font-weight: 500;
        }
        .building-preview-header .company-logo {
            height: 28px;
        }
        
        /* 3열 메인 컨텐츠 - v4.2: 좌측/중앙 컬럼 높이 동기화 */
        .building-preview-body {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 1.3fr;
            gap: 16px;
            padding: 16px;
            overflow: hidden;
            min-height: 0;
        }
        
        /* 좌측 컬럼: 이미지 + 지도 - 50:50 고정 비율 */
        .preview-col-left {
            display: grid;
            grid-template-rows: 1fr 1fr;
            gap: 12px;
            padding-right: 14px;
            border-right: 1px solid #e5e7eb;
            min-height: 0;
            height: 100%;
        }
        .preview-col-left > div {
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }
        .preview-section-title {
            font-size: 11px;
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-shrink: 0;
        }
        .preview-building-photo {
            flex: 1;
            background: #f1f5f9;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 32px;
            overflow: hidden;
            cursor: pointer;
            min-height: 0;
        }
        .preview-building-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .preview-location-map {
            flex: 1;
            background: #1e3a5f;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 24px;
            overflow: hidden;
            min-height: 0;
            position: relative;
        }
        .preview-location-map img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .preview-location-map .kakao-map-container {
            width: 100%;
            height: 100%;
            min-height: 100px;
        }
        
        /* 지도 모드 토글 */
        .location-mode-toggle {
            display: flex;
            gap: 4px;
            margin-left: auto;
        }
        .location-mode-btn {
            padding: 3px 8px;
            border: 1px solid var(--border-color);
            border-radius: 3px;
            background: var(--bg-primary);
            font-size: 11px;
            cursor: pointer;
            color: var(--text-muted);
        }
        .location-mode-btn:hover {
            border-color: var(--accent-color);
        }
        .location-mode-btn.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* 로드뷰 버튼 */
        .roadview-btn {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 24px;
            height: 24px;
            background: rgba(255,255,255,0.95);
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            z-index: 10;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .roadview-btn:hover {
            background: #f0f0f0;
        }
        
        /* 중앙 컬럼: 빌딩정보 + 평면도 - 50:50 고정 비율 (좌측과 동일) */
        .preview-col-center {
            display: grid;
            grid-template-rows: 1fr 1fr;
            gap: 12px;
            padding: 0 14px;
            border-right: 1px solid #e5e7eb;
            min-height: 0;
            height: 100%;
        }
        .preview-col-center > div {
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }
        .preview-info-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .preview-info-table th {
            background: #f8fafc;
            color: #64748b;
            padding: 5px 10px;
            text-align: left;
            font-weight: 500;
            width: 80px;
            white-space: nowrap;
            border-bottom: 1px solid #e5e7eb;
        }
        .preview-info-table td {
            padding: 5px 10px;
            color: #1e293b;
            border-bottom: 1px solid #e5e7eb;
        }
        .preview-floor-plan {
            flex: 1;
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 24px;
            overflow: hidden;
            cursor: pointer;
            min-height: 0;
        }
        .preview-floor-plan img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* 우측 컬럼: 공실 + 임대조건 + 담당자 - v4.1 */
        .preview-col-right {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-left: 14px;
            overflow-y: auto;
            min-height: 0;
            height: 100%;
        }
        .preview-vacancy-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .preview-vacancy-table th {
            background: #1e3a5f;
            color: white;
            padding: 7px 5px;
            text-align: center;
            font-weight: 600;
            font-size: 11px;
        }
        .preview-vacancy-table td {
            padding: 6px 5px;
            text-align: center;
            border-bottom: 1px solid #e5e7eb;
            font-size: 12px;
        }
        .preview-vacancy-table .floor {
            font-weight: 700;
            color: #1e3a5f;
        }
        .preview-vacancy-table tr:nth-child(even) {
            background: #f8fafc;
        }
        .preview-vacancy-table .total-row {
            background: #f1f5f9;
            font-weight: 600;
        }
        
        /* ★ 정렬 가능 헤더 스타일 */
        .preview-vacancy-table .sortable-header {
            cursor: pointer;
            user-select: none;
            transition: background 0.2s;
        }
        .preview-vacancy-table .sortable-header:hover {
            background: #2d4a6f;
        }
        
        /* ★ 공실 없음 표시 스타일 */
        .preview-vacancy-table .no-vacancy-cell {
            padding: 24px 12px !important;
        }
        .no-vacancy-message {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: #64748b;
        }
        .no-vacancy-icon {
            font-size: 24px;
            opacity: 0.5;
        }
        .no-vacancy-text {
            font-size: 12px;
            color: #94a3b8;
        }
        
        /* 임대조건 테이블 */
        .preview-rent-section {
            background: #f8fafc;
            border-radius: 4px;
            padding: 8px;
        }
        .preview-rent-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .preview-rent-table th {
            background: #1e3a5f;
            color: white;
            padding: 6px;
            text-align: center;
            font-weight: 600;
            font-size: 11px;
        }
        .preview-rent-table td {
            padding: 6px;
            text-align: center;
            border: 1px solid #e5e7eb;
            background: white;
        }
        
        /* NOTE 섹션 */
        .preview-note-section {
            margin-bottom: 8px;
            background: #fef3c7;
            border-radius: 4px;
            padding: 10px;
            border-left: 3px solid #f59e0b;
        }
        .preview-note-section.preview-note-empty {
            background: #f8fafc;
            border-left-color: #cbd5e1;
        }
        .preview-note-section .preview-section-title {
            color: #92400e;
            font-size: 12px;
            margin-bottom: 6px;
        }
        .preview-note-empty .preview-section-title {
            color: #64748b;
        }
        .preview-note-placeholder {
            font-size: 13px;
            color: #94a3b8;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            border: 1px dashed #cbd5e1;
            border-radius: 4px;
            transition: all 0.2s;
        }
        .preview-note-placeholder:hover {
            background: #e2e8f0;
            color: #475569;
            border-color: #94a3b8;
        }
        .add-note-btn {
            background: #3b82f6 !important;
            color: white !important;
            font-size: 11px !important;
            padding: 3px 8px !important;
            border-radius: 3px !important;
        }
        .preview-note-content {
            font-size: 13px;
            color: #78350f;
            line-height: 1.5;
        }
        .preview-note-content .note-item {
            margin-bottom: 3px;
        }
        .preview-note-content .note-item:last-child {
            margin-bottom: 0;
        }
        
        /* 담당자 테이블 */
        .preview-contact-section {
            margin-top: auto;
        }
        .preview-contact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .preview-contact-header .section-title {
            font-size: 12px;
            font-weight: 600;
            color: #1e3a5f;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .preview-contact-header .default-badge {
            font-size: 10px;
            padding: 2px 6px;
            background: #fef3c7;
            color: #92400e;
            border-radius: 4px;
            font-weight: 500;
        }
        .preview-contact-header .custom-badge {
            font-size: 10px;
            padding: 2px 6px;
            background: #d1fae5;
            color: #065f46;
            border-radius: 4px;
            font-weight: 500;
        }
        .preview-contact-actions {
            display: flex;
            gap: 4px;
        }
        .preview-contact-actions button {
            padding: 4px 8px;
            font-size: 11px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-primary);
            cursor: pointer;
            transition: all 0.15s;
        }
        .preview-contact-actions button:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }
        .preview-contact-actions .btn-change {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .preview-contact-actions .btn-change:hover {
            background: #2563eb;
        }
        .preview-contact-actions .btn-reset {
            color: #dc2626;
            border-color: #fecaca;
        }
        .preview-contact-actions .btn-reset:hover {
            background: #fee2e2;
            border-color: #dc2626;
        }
        .preview-contact-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        .preview-contact-table th {
            background: #1e3a5f;
            color: white;
            padding: 6px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
        }
        .preview-contact-table td {
            padding: 6px 8px;
            text-align: center;
            border: 1px solid #e5e7eb;
            font-size: 12px;
        }
        
        /* ===== 담당자 변경 모달 v4.3 ===== */
        .contact-change-modal {
            max-width: 600px;
            max-height: 80vh;
        }
        .contact-change-modal .modal-header {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        .contact-change-modal .modal-close {
            color: white;
        }
        .contact-change-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
        }
        .contact-change-tab {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.15s;
        }
        .contact-change-tab:hover {
            background: var(--bg-secondary);
        }
        .contact-change-tab.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }
        .contact-change-panel {
            padding: 16px;
            max-height: 400px;
            overflow-y: auto;
        }
        .contact-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.15s;
        }
        .contact-option:hover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }
        .contact-option.selected {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }
        .contact-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: #3b82f6;
        }
        .contact-option .info {
            flex: 1;
        }
        .contact-option .name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 2px;
        }
        .contact-option .detail {
            font-size: 12px;
            color: var(--text-muted);
        }
        .contact-option .badge {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 4px;
            background: #e0e7ff;
            color: #4338ca;
        }
        .contact-current-info {
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 16px;
        }
        .contact-current-info .label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }
        .contact-current-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        .contact-current-chip {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            font-size: 12px;
        }
        .contact-current-chip .remove {
            width: 14px;
            height: 14px;
            border: none;
            background: #fee2e2;
            color: #dc2626;
            border-radius: 50%;
            cursor: pointer;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .contact-current-chip .remove:hover {
            background: #dc2626;
            color: white;
        }
        .contact-change-notice {
            padding: 10px 12px;
            background: #fef3c7;
            border-radius: 6px;
            font-size: 12px;
            color: #92400e;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* 단위 표시 */
        .preview-unit-note {
            font-size: 11px;
            color: #94a3b8;
            text-align: right;
            margin-bottom: 4px;
        }
        
        /* 편집 모드 스타일 */
        .preview-editable {
            cursor: pointer;
            transition: all 0.15s;
        }
        .preview-editable:hover {
            box-shadow: 0 0 0 2px #3b82f6;
        }
        
        /* 임대조건 테이블 */
        .preview-price-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        .preview-price-table th {
            background: #1e3a5f;
            color: white;
            padding: 10px 12px;
            text-align: center;
            font-weight: 600;
        }
        .preview-price-table td {
            padding: 10px 12px;
            text-align: center;
            border-bottom: 1px solid #e2e8f0;
        }
        .preview-price-table tr:nth-child(even) {
            background: #f8fafc;
        }
        
        /* 플로팅 메뉴 */
        .floating-menu {
            position: sticky;
            top: 0;
            z-index: 100;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            padding: 10px 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }
        .floating-menu-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .floating-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
        }
        .floating-status.pending {
            background: #fef3c7;
            color: #92400e;
        }
        .floating-status.confirmed {
            background: #d1fae5;
            color: #065f46;
        }
        .floating-shortcuts {
            display: flex;
            gap: 6px;
        }
        .floating-shortcut {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-secondary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .floating-shortcut:hover {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        
        /* 이미지 관리 탭 */
        .image-manager {
            margin-top: 16px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 10px;
        }
        .image-manager-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .image-manager-title {
            font-size: 13px;
            font-weight: 600;
        }
        .image-tabs {
            display: flex;
            gap: 4px;
        }
        .image-tab {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.15s;
        }
        .image-tab:hover {
            border-color: var(--accent-color);
        }
        .image-tab.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        .image-grid {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            min-height: 60px;
            padding: 12px;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 1px dashed var(--border-color);
        }
        .image-thumb {
            position: relative;
            width: 70px;
            height: 52px;
            border-radius: 4px;
            overflow: hidden;
            border: 2px solid var(--border-color);
            cursor: pointer;
        }
        .image-thumb.main {
            border-color: #f59e0b;
        }
        .image-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .image-thumb .remove-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 16px;
            height: 16px;
            border: none;
            background: rgba(239,68,68,0.9);
            color: white;
            border-radius: 50%;
            font-size: 10px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .image-thumb:hover .remove-btn {
            display: flex;
        }
        .image-add-btn {
            width: 70px;
            height: 52px;
            border: 2px dashed var(--border-color);
            border-radius: 4px;
            background: transparent;
            color: var(--text-muted);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .image-add-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }
        .image-empty {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 12px;
        }
        
        /* General Info 버튼 */
        .info-action-btns {
            display: flex;
            gap: 6px;
        }
        .info-action-btn {
            padding: 4px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-primary);
            font-size: 12px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        .info-action-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }
        
        /* 기준층 정보 편집 */
        .standard-floor-section {
            margin-top: 12px;
            padding: 12px;
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
        }
        .standard-floor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .standard-floor-title {
            font-size: 13px;
            font-weight: 600;
            color: #0369a1;
        }
        .standard-floor-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        .standard-floor-field label {
            display: block;
            font-size: 10px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }
        .standard-floor-field input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 12px;
        }
        
        .preview-vacancy-table .actions {
            display: flex;
            gap: 4px;
            justify-content: center;
        }
        .preview-vacancy-table .btn-sm {
            padding: 4px 8px;
            font-size: 11px;
        }
        
        /* 공실 추가 영역 */
        .vacancy-add-section {
            margin-top: 16px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: 10px;
            border: 1px dashed var(--border-color);
        }
        .vacancy-add-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }
        .vacancy-add-tab {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            font-size: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.15s;
        }
        .vacancy-add-tab:hover {
            border-color: var(--accent-color);
        }
        .vacancy-add-tab.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        .vacancy-add-form {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr auto;
            gap: 8px;
            align-items: end;
        }
        .vacancy-add-form .form-field {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .vacancy-add-form .form-field label {
            font-size: 10px;
            color: var(--text-muted);
        }
        .vacancy-add-form .form-field input {
            padding: 8px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 13px;
        }
        
        /* 외부 공실 선택 */
        .external-source-select {
            margin-bottom: 12px;
        }
        .external-source-select select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 13px;
            background: var(--bg-primary);
        }
        .external-vacancy-grid {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        .external-vacancy-row {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.15s;
        }
        .external-vacancy-row:last-child {
            border-bottom: none;
        }
        .external-vacancy-row:hover {
            background: var(--bg-secondary);
        }
        .external-vacancy-row input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        /* ===== 간지 에디터 (전체화면 레이아웃) ===== */
        .divider-editor-full {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            margin-top: 60px;
        }
        
        .divider-editor-header-bar {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .divider-title-area {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .divider-icon {
            font-size: 24px;
        }
        
        .divider-building-name {
            font-size: 20px;
            font-weight: 700;
            color: white;
        }
        
        .divider-badge {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .divider-region-info {
            color: rgba(255,255,255,0.9);
            font-size: 14px;
        }
        
        .divider-editor-body {
            padding: 24px;
        }
        
        .divider-form-group {
            margin-bottom: 24px;
        }
        
        .divider-form-group:last-child {
            margin-bottom: 0;
        }
        
        .divider-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .divider-label .label-hint {
            font-size: 12px;
            font-weight: 400;
            color: var(--text-muted);
        }
        
        .divider-title-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            background: var(--bg-secondary);
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        
        .divider-title-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .divider-content-group #dividerQuillEditor {
            height: calc(100vh - 400px);
            min-height: 400px;
            max-height: 600px;
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        
        .divider-content-group .ql-toolbar {
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            background: var(--bg-secondary);
        }
        
        .divider-content-group .ql-container {
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
            font-size: 14px;
        }
        
        .divider-content-group .ql-editor {
            min-height: 350px;
        }
        
        .divider-content-group .ql-editor img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 12px 0;
        }
        
        /* 구버전 CSS 유지 (하위 호환) */
        .divider-editor {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .divider-editor-header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .divider-editor-header h3 {
            margin: 0;
            font-size: 18px;
        }
        .divider-setting-group {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
        }
        .divider-setting-group:last-child {
            border-bottom: none;
        }
        .divider-setting-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 8px;
        }
        .divider-template-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 16px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .divider-template-option {
            aspect-ratio: 3/4;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.2s;
            background: white;
            display: flex;
            flex-direction: column;
            padding: 8px;
        }
        .divider-template-option:hover {
            border-color: var(--accent-color);
        }
        .divider-template-option.active {
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }
        .divider-template-option .tpl-title {
            height: 12px;
            background: #e5e7eb;
            border-radius: 2px;
            margin-bottom: 8px;
        }
        .divider-template-option .tpl-content {
            flex: 1;
            background: #f3f4f6;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            font-size: 20px;
        }
        .divider-template-option .tpl-name {
            font-size: 9px;
            text-align: center;
            color: var(--text-muted);
            margin-top: 6px;
        }
        
        /* 간지 프리뷰 */
        .divider-preview-container {
            padding: 20px;
            background: var(--bg-secondary);
            display: flex;
            justify-content: center;
        }
        .divider-preview {
            width: 280px;
            aspect-ratio: 3/4;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .divider-preview .title-area {
            padding: 16px;
            border-bottom: 2px solid #e5e7eb;
            min-height: 50px;
        }
        .divider-preview .content-area {
            flex: 1;
            padding: 16px;
            overflow: hidden;
        }
        
        /* 간지 에디터 영역 */
        .divider-editor-area {
            padding: 20px;
        }
        .divider-title-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .divider-title-input:focus {
            outline: none;
            border-color: #8b5cf6;
        }
        
        /* ===== 컨택포인트 관리 ===== */
        .cp-tab {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: transparent;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.15s;
        }
        .cp-tab:hover {
            background: var(--bg-secondary);
        }
        .cp-tab.active {
            color: #10b981;
            border-bottom-color: #10b981;
        }
        .cp-panel {
            min-height: 300px;
        }
        .cp-slot {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 10px;
            background: var(--bg-primary);
        }
        .cp-slot .order {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
        }
        .cp-slot .info {
            flex: 1;
        }
        .cp-slot .name {
            font-weight: 600;
            font-size: 14px;
        }
        .cp-slot .email {
            font-size: 11px;
            color: var(--text-muted);
        }
        .cp-slot .actions {
            display: flex;
            gap: 6px;
        }
        .cp-slot .actions button {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .cp-slot .move-btn {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }
        .cp-slot .remove-btn {
            background: #fee2e2;
            color: #dc2626;
        }
        .cp-add-slot {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 16px;
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            color: var(--text-muted);
            font-size: 13px;
            transition: all 0.15s;
        }
        .cp-add-slot:hover {
            border-color: #10b981;
            color: #10b981;
            background: rgba(16, 185, 129, 0.05);
        }
        .cp-building-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.15s;
        }
        .cp-building-item:hover {
            background: var(--bg-secondary);
        }
        .cp-building-item:last-child {
            border-bottom: none;
        }
        .cp-building-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #10b981;
        }
        
        /* Quill 에디터 커스텀 */
        .quill-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }
        .ql-toolbar {
            border-bottom: 1px solid var(--border-color) !important;
            border-top: none !important;
            border-left: none !important;
            border-right: none !important;
            background: var(--bg-secondary);
        }
        .ql-container {
            border: none !important;
            min-height: 300px;
            font-size: 14px;
        }
        .ql-editor {
            min-height: 300px;
        }

        /* ===== 이미지 업로드 영역 ===== */
        .image-upload-section {
            margin-bottom: 20px;
        }
        .image-upload-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .image-upload-header .title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
        }
        .image-upload-header .count {
            font-size: 12px;
            color: var(--text-muted);
        }
        .image-grid-upload {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
        }
        .image-thumb {
            position: relative;
            aspect-ratio: 4/3;
            border-radius: 8px;
            overflow: hidden;
            background: var(--bg-tertiary);
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }
        .image-thumb:hover {
            border-color: var(--accent-color);
        }
        .image-thumb.main {
            border-color: #f59e0b;
            box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.3);
        }
        .image-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .image-thumb .badge-main {
            position: absolute;
            top: 4px;
            left: 4px;
            background: #f59e0b;
            color: white;
            font-size: 9px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .image-thumb .badge-order {
            position: absolute;
            bottom: 4px;
            left: 4px;
            background: rgba(0,0,0,0.6);
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .image-thumb .actions {
            position: absolute;
            top: 4px;
            right: 4px;
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .image-thumb:hover .actions {
            opacity: 1;
        }
        .image-thumb .actions button {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .image-thumb .actions .btn-main {
            background: #f59e0b;
            color: white;
        }
        .image-thumb .actions .btn-delete {
            background: #ef4444;
            color: white;
        }
        .image-thumb .actions .btn-move {
            background: rgba(0,0,0,0.6);
            color: white;
        }
        .image-add-btn {
            aspect-ratio: 4/3;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            background: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-muted);
            font-size: 12px;
        }
        .image-add-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        .image-add-btn .icon {
            font-size: 24px;
        }

        /* ===== 표지 템플릿 에디터 ===== */
        .cover-editor {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .cover-editor-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 24px;
        }
        .cover-editor-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .cover-editor-title h3 {
            font-size: 20px;
            font-weight: 700;
            margin: 0;
        }
        
        /* 템플릿 선택 */
        .template-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            padding: 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .template-option {
            position: relative;
            aspect-ratio: 297/210; /* A4 가로 비율 */
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.2s;
            background: white;
        }
        .template-option:hover {
            border-color: var(--accent-color);
            transform: translateY(-2px);
        }
        .template-option.active {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .template-option .template-preview {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 0;
            font-size: 8px;
            position: relative;
        }
        .template-option .template-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 6px 10px;
            font-size: 11px;
            text-align: center;
            font-weight: 500;
        }
        .template-option .check-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 22px;
            height: 22px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            z-index: 5;
        }
        .template-option.active .check-badge {
            display: flex;
        }
        
        /* 템플릿 A: 전체 배경 */
        .tpl-a .bg-area { flex:1; background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border-radius: 4px; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; }
        .tpl-a .title-area { height: 20px; background: rgba(0,0,0,0.1); border-radius: 2px; margin-bottom: 4px; }
        .tpl-a .sub-area { height: 12px; background: rgba(0,0,0,0.05); border-radius: 2px; width: 60%; margin: 0 auto; }
        
        /* 템플릿 B: 상단 로고 + 중앙 이미지 */
        .tpl-b .logo-area { height: 16px; background: #e5e7eb; border-radius: 2px; margin-bottom: 6px; width: 40%; }
        .tpl-b .img-area { flex:1; background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border-radius: 4px; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; }
        .tpl-b .title-area { height: 16px; background: rgba(0,0,0,0.1); border-radius: 2px; margin-bottom: 4px; }
        .tpl-b .info-area { height: 10px; background: rgba(0,0,0,0.05); border-radius: 2px; width: 50%; }
        
        /* 템플릿 C: 분할 레이아웃 */
        .tpl-c { flex-direction: row !important; }
        .tpl-c .left { flex: 1; background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); border-radius: 4px; margin-right: 6px; display: flex; align-items: center; justify-content: center; }
        .tpl-c .right { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .tpl-c .right .logo { height: 14px; background: #e5e7eb; border-radius: 2px; margin-bottom: 6px; width: 60%; }
        .tpl-c .right .title { height: 14px; background: rgba(0,0,0,0.1); border-radius: 2px; margin-bottom: 4px; }
        .tpl-c .right .sub { height: 10px; background: rgba(0,0,0,0.05); border-radius: 2px; width: 80%; }
        
        /* 표지 미리보기 */
        .cover-preview-container {
            padding: 20px;
            display: flex;
            justify-content: center;
            background: var(--bg-secondary);
        }
        .cover-preview {
            width: 100%;
            max-width: 500px;
            aspect-ratio: 297 / 210; /* A4 가로 비율 */
            background: #2d3748;
            border-radius: 4px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            overflow: hidden;
            position: relative;
        }
        /* 표지 설정 페이지용 작은 미리보기 */
        .cover-preview-mini {
            width: 280px;
            aspect-ratio: 297 / 210;
            background: #2d3748;
            border-radius: 6px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
            overflow: hidden;
            position: relative;
        }
        .cover-preview-mini .cover-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 35%;
            overflow: hidden;
        }
        .cover-preview-mini .cover-bg .skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            opacity: 0.5;
        }
        .cover-preview-mini .cover-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 90%;
        }
        .cover-preview-mini .cover-title {
            font-size: 14px;
            font-weight: 700;
            color: white;
            margin-bottom: 3px;
        }
        .cover-preview-mini .cover-subtitle {
            font-size: 9px;
            color: #ec4899;
            font-weight: 500;
        }
        .cover-preview-mini .cover-slogan {
            position: absolute;
            bottom: 28px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 8px;
            color: rgba(255,255,255,0.7);
            font-style: italic;
            text-align: center;
            white-space: nowrap;
        }
        .cover-preview-mini .cover-logo {
            position: absolute;
            bottom: 10px;
            left: 16px;
            right: 16px;
            display: flex;
        }
        .cover-preview-mini .cover-logo img {
            height: 16px;
            object-fit: contain;
        }
        .cover-preview-mini.ending-mini-preview {
            background: #1a1f2e !important;
        }
        
        /* 표지 설정 페이지용 큰 미리보기 */
        .cover-preview-large {
            width: 100%;
            aspect-ratio: 297 / 210;
            background: #2d3748;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.25);
            overflow: hidden;
            position: relative;
        }
        .cover-preview-large .cover-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 35%;
            overflow: hidden;
        }
        .cover-preview-large .cover-bg .skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            opacity: 0.5;
        }
        .cover-preview-large .cover-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 90%;
        }
        .cover-preview-large .cover-title {
            font-size: 28px;
            font-weight: 700;
            color: white;
            margin-bottom: 6px;
        }
        .cover-preview-large .cover-subtitle {
            font-size: 14px;
            color: #ec4899;
            font-weight: 500;
        }
        .cover-preview-large .cover-slogan {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            color: rgba(255,255,255,0.7);
            font-style: italic;
            text-align: center;
            white-space: nowrap;
        }
        .cover-preview-large .cover-logo {
            position: absolute;
            bottom: 20px;
            left: 30px;
            right: 30px;
            display: flex;
        }
        .cover-preview-large .cover-logo img {
            height: 28px;
            object-fit: contain;
        }
        .cover-preview-large.ending-preview-large {
            background: #1a1f2e !important;
        }
        /* 엔딩 미리보기 내부 스타일 */
        .ending-preview-large .ending-mini-content {
            padding: 24px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .ending-preview-large .ending-mini-headlines {
            font-size: 11px;
            color: rgba(255,255,255,0.8);
            line-height: 1.6;
            margin-bottom: 8px;
        }
        .ending-preview-large .ending-mini-company {
            font-size: 18px;
            font-weight: 700;
            color: white;
            margin-bottom: 12px;
        }
        .ending-preview-large .ending-mini-desc {
            font-size: 9px;
            color: rgba(255,255,255,0.6);
            line-height: 1.5;
            margin-bottom: 16px;
        }
        .ending-preview-large .ending-mini-images {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        .ending-preview-large .ending-mini-images .img-thumb {
            width: 40px;
            height: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        .ending-preview-large .ending-mini-images .img-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .cover-preview .cover-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            overflow: hidden;
        }
        .cover-preview .cover-bg .skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            opacity: 0.5;
        }
        .cover-preview .cover-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 90%;
        }
        .cover-preview .cover-title {
            font-size: 20px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
        }
        .cover-preview .cover-subtitle {
            font-size: 11px;
            color: #ec4899;
            font-weight: 500;
        }
        .cover-preview .cover-slogan {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: rgba(255,255,255,0.7);
            font-style: italic;
            text-align: center;
        }
        .cover-preview .cover-logo {
            position: absolute;
            bottom: 16px;
            left: 24px;
            right: 24px;
            display: flex;
        }
        .cover-preview .cover-logo img {
            height: 20px;
            object-fit: contain;
        }
        
        /* 표지 설정 폼 */
        .cover-settings {
            padding: 20px 24px;
        }
        .cover-setting-group {
            margin-bottom: 20px;
        }
        .cover-setting-group:last-child {
            margin-bottom: 0;
        }
        .cover-setting-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .cover-setting-label .hint {
            font-weight: 400;
            font-size: 11px;
            color: var(--text-muted);
        }
        .cover-setting-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .cover-setting-input:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        
        /* 이미지 슬롯 */
        .image-slot {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-secondary);
        }
        .image-slot:hover {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        .image-slot.has-image {
            border-style: solid;
            padding: 0;
            position: relative;
        }
        .image-slot.has-image img {
            width: 100%;
            border-radius: 6px;
        }
        .image-slot.has-image .remove-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 28px;
            height: 28px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .image-slot .placeholder {
            color: var(--text-muted);
            font-size: 13px;
        }
        .image-slot .placeholder .icon {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
        }
        
        /* 작은 로고 이미지 슬롯 */
        .image-slot-small {
            width: 80px;
            height: 60px;
            border: 2px dashed var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            position: relative;
            overflow: visible;
        }
        .image-slot-small:hover {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        .image-slot-small img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 4px;
        }
        .image-slot-small .remove-btn {
            position: absolute;
            top: -6px;
            right: -6px;
            width: 18px;
            height: 18px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5;
        }
        .image-slot-small .placeholder {
            color: var(--text-muted);
            font-size: 11px;
            text-align: center;
            line-height: 1.3;
        }
        
        /* 로고 위치 선택 버튼 */
        .logo-position-selector {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .logo-position-selector .position-btn-group {
            display: flex;
            gap: 4px;
        }
        .position-btn {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.15s;
            text-align: center;
            white-space: nowrap;
            min-width: 70px;
        }
        .position-btn:hover {
            border-color: var(--accent-color);
            background: var(--bg-secondary);
        }
        .position-btn.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* 전체 미리보기 */
        .cover-preview-full {
            width: 100%;
            aspect-ratio: 297 / 210;
            max-width: 850px;
            background: #2d3748;
            border-radius: 12px;
            border: 3px solid #4a5568;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }
        .cover-preview-full .cover-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            overflow: hidden;
        }
        .cover-preview-full .cover-bg .skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 80px;
            opacity: 0.5;
        }
        .cover-preview-full .cover-content {
            position: relative;
            z-index: 1;
            padding: 40px 50px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .cover-preview-full .cover-logo {
            display: flex;
            margin-bottom: 20px;
        }
        .cover-preview-full .cover-logo img {
            max-height: 50px;
            max-width: 200px;
            object-fit: contain;
        }
        .cover-preview-full .cover-logo .logo-placeholder {
            height: 40px;
            padding: 8px 20px;
            background: rgba(255,255,255,0.15);
            border-radius: 6px;
            font-size: 14px;
            color: rgba(255,255,255,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .cover-preview-full .cover-text {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .cover-preview-full .cover-title {
            font-size: 42px;
            font-weight: 700;
            color: #f0f0f0;
            letter-spacing: 2px;
            margin-bottom: 12px;
        }
        .cover-preview-full .cover-subtitle {
            font-size: 18px;
            color: #ec4899;
            font-weight: 500;
        }
        .cover-preview-full .cover-slogan {
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            font-style: italic;
            margin-top: auto;
        }
        .cover-preview-full .preview-close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 36px;
            height: 36px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .cover-preview-full .preview-close-btn:hover {
            background: rgba(0,0,0,0.7);
        }
        
        /* 로고 전용 슬롯 (작은 크기) */
        .logo-slot-container {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        .logo-slot {
            width: 120px;
            height: 60px;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .logo-slot:hover {
            border-color: var(--accent-color);
        }
        .logo-slot.has-image {
            border-style: solid;
            padding: 8px;
        }
        .logo-slot.has-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .logo-slot.has-image .remove-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 18px;
            height: 18px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 10px;
            display: none;
            align-items: center;
            justify-content: center;
        }
        .logo-slot:hover .remove-btn {
            display: flex;
        }
        .logo-slot .placeholder {
            color: var(--text-muted);
            font-size: 11px;
            text-align: center;
        }
        .logo-slot .placeholder .icon {
            font-size: 20px;
            margin-bottom: 2px;
            display: block;
        }
        
        /* 로고 위치 선택 */
        .logo-position-selector {
            display: flex;
            gap: 4px;
        }
        .logo-position-btn {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-primary);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.15s;
        }
        .logo-position-btn:hover {
            border-color: var(--accent-color);
        }
        .logo-position-btn.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* 로고 위치별 CSS */
        .cover-preview .cover-logo.pos-left {
            right: auto;
            left: 24px;
        }
        .cover-preview .cover-logo.pos-center {
            right: auto;
            left: 50%;
            transform: translateX(-50%);
        }
        .cover-preview .cover-logo.pos-right {
            right: 24px;
            left: auto;
        }
        
        /* 전체 미리보기 모달 */
        .fullpreview-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .fullpreview-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.5);
        }
        .fullpreview-title {
            color: white;
            font-size: 16px;
            font-weight: 600;
        }
        .fullpreview-close {
            font-size: 28px;
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.7;
            padding: 4px 12px;
        }
        .fullpreview-close:hover {
            opacity: 1;
        }
        .fullpreview-content {
            width: 100%;
            max-width: 1000px;
            aspect-ratio: 297 / 210;
            background: white;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .fullpreview-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            background: rgba(0,0,0,0.5);
        }
        .fullpreview-nav-btn {
            padding: 10px 24px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .fullpreview-nav-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.3);
        }
        .fullpreview-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .fullpreview-page-info {
            color: white;
            font-size: 14px;
            min-width: 100px;
            text-align: center;
        }
        .fullpreview-page-dots {
            display: flex;
            gap: 6px;
        }
        .fullpreview-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            cursor: pointer;
            transition: all 0.2s;
        }
        .fullpreview-dot.active {
            background: white;
            transform: scale(1.2);
        }
        .fullpreview-dot:hover {
            background: rgba(255,255,255,0.6);
        }
        
        /* ========== 전체 목차 페이지 (이미지 2번 스타일) ========== */
        .fullpreview-toc-full {
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            flex-direction: column;
            padding: 0;
        }
        .toc-full-header {
            background: #ec4899;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-full-title {
            font-size: 28px;
            font-weight: 700;
            color: white;
            letter-spacing: 8px;
        }
        .toc-full-logo {
            height: 40px;
            object-fit: contain;
        }
        .toc-full-accent-bar {
            height: 6px;
            background: linear-gradient(90deg, #ec4899, #f472b6);
        }
        .toc-full-body {
            flex: 1;
            padding: 30px 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 30px;
            align-content: start;
        }
        .toc-full-column {
            display: flex;
            flex-direction: column;
        }
        .toc-full-region-header {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e5e7eb;
        }
        .toc-region-icon {
            font-size: 14px;
        }
        .toc-region-label {
            font-size: 16px;
            font-weight: 700;
            color: #ec4899;
        }
        .toc-full-region-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .toc-full-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .toc-full-item:hover {
            color: #ec4899;
            transform: translateX(4px);
        }
        .toc-item-num {
            font-size: 12px;
            color: #64748b;
            min-width: 18px;
        }
        .toc-item-name {
            font-size: 13px;
            color: #334155;
        }
        .toc-full-item:hover .toc-item-name {
            color: #ec4899;
            text-decoration: underline;
        }
        
        /* ========== 권역별 목차 페이지 (이미지 1번 스타일) ========== */
        .fullpreview-toc-region {
            width: 100%;
            height: 100%;
            background: #2d3748;
            display: flex;
            flex-direction: column;
            padding: 40px 60px;
            position: relative;
            overflow: hidden;
        }
        .toc-region-main-header {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .toc-region-title-area {
            margin-bottom: 30px;
        }
        .toc-region-title {
            font-size: 36px;
            font-weight: 700;
            color: #f0f0f0;
            margin-bottom: 16px;
        }
        .toc-region-divider {
            width: 100%;
            height: 2px;
            background: rgba(255,255,255,0.3);
        }
        .toc-region-list-area {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-width: 400px;
        }
        .toc-region-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 6px 0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .toc-region-item:hover {
            transform: translateX(8px);
        }
        .toc-region-item-num {
            font-size: 14px;
            font-weight: 700;
            color: #f0f0f0;
            min-width: 24px;
        }
        .toc-region-item-name {
            font-size: 15px;
            color: #e2e8f0;
            font-weight: 500;
        }
        .toc-region-item:hover .toc-region-item-name {
            color: #ec4899;
            text-decoration: underline;
        }
        .toc-region-skyline {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 60%;
            height: 150px;
            opacity: 0.6;
        }
        .toc-region-skyline svg {
            width: 100%;
            height: 100%;
        }
        .toc-region-logo {
            position: absolute;
            bottom: 30px;
            right: 40px;
            height: 30px;
            object-fit: contain;
        }
        
        /* 표지 페이지 (전체 미리보기용) */
        .fullpreview-cover {
            width: 100%;
            height: 100%;
            background: #1a1f2e;
            padding: 60px;
            position: relative;
        }
        .fullpreview-cover .cover-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 120px;
            overflow: hidden;
        }
        .fullpreview-cover .cover-bg .skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 80px;
            opacity: 0.5;
        }
        .fullpreview-cover .cover-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 90%;
        }
        .fullpreview-cover .cover-title {
            font-size: 42px;
            font-weight: 700;
            color: #f0f0f0;
            letter-spacing: 2px;
            margin-bottom: 8px;
        }
        .fullpreview-cover .cover-subtitle {
            font-size: 18px;
            color: #ec4899;
            font-weight: 500;
        }
        .fullpreview-cover .cover-slogan {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            font-style: italic;
            letter-spacing: 1px;
            text-align: center;
        }
        .fullpreview-cover .cover-logo {
            position: absolute;
            bottom: 40px;
            left: 60px;
            right: 80px;
            display: flex;
            overflow: visible;
        }
        .fullpreview-cover .cover-logo img {
            max-height: 50px;
            object-fit: contain;
            max-width: 100%;
        }
        
        /* 빌딩 페이지 (전체 미리보기용) - v4.0 편집 모드와 동일 */
        .fullpreview-building {
            width: 100%;
            height: 100%;
            background: white;
            padding: 24px 28px;
            display: flex;
            flex-direction: column;
        }
        .fullpreview-building-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 12px;
            border-bottom: 2px solid #1e3a5f;
            margin-bottom: 16px;
            flex-shrink: 0;
        }
        .fullpreview-building-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e3a5f;
        }
        .fullpreview-building-region {
            font-size: 13px;
            color: #ec4899;
            font-weight: 600;
        }
        .fullpreview-building-body {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 1.3fr;
            gap: 16px;
            min-height: 0;
        }
        
        /* 간지 페이지 (전체 미리보기용) */
        .fullpreview-divider {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
        }
        .fullpreview-divider-content {
            max-width: 80%;
            text-align: center;
        }
        
        .cover-fullpreview-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        .cover-fullpreview-modal .close-btn {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 36px;
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.7;
        }
        .cover-fullpreview-modal .close-btn:hover {
            opacity: 1;
        }
        .cover-fullpreview-content {
            width: 100%;
            max-width: 900px;
            aspect-ratio: 297 / 210;
            background: #1e293b;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        .cover-fullpreview-content .cover-preview-inner {
            width: 100%;
            height: 100%;
            padding: 60px;
        }
        .cover-fullpreview-content .cover-title {
            font-size: 48px;
        }
        .cover-fullpreview-content .cover-title-underline {
            width: 180px;
            height: 4px;
        }
        .cover-fullpreview-content .cover-subtitle {
            font-size: 20px;
            margin-top: 16px;
        }
        .cover-fullpreview-content .cover-slogan {
            font-size: 18px;
            bottom: 50px;
            left: 60px;
        }
        .cover-fullpreview-content .cover-logo {
            bottom: 40px;
        }
        .cover-fullpreview-content .cover-logo.pos-left {
            left: 60px;
        }
        .cover-fullpreview-content .cover-logo.pos-center {
            left: 50%;
            transform: translateX(-50%);
        }
        .cover-fullpreview-content .cover-logo.pos-right {
            right: 60px;
        }
        .cover-fullpreview-content .cover-logo img {
            height: 48px;
        }
        .cover-fullpreview-content .cover-skyline {
            bottom: 20px;
            right: 40px;
        }
        .cover-fullpreview-content .cover-skyline svg {
            width: 350px;
            height: 180px;
        }

        /* ===== 빌딩 선택 모달 (장바구니 형태) ===== */
        .building-picker-modal {
            display: flex;
            width: 900px;
            max-width: 95vw;
            height: 70vh;
            max-height: 600px;
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        /* 좌측: 검색 및 빌딩 목록 */
        .picker-left {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }
        .picker-search {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-secondary);
        }
        .picker-search input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .picker-search input:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        .picker-filters {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .picker-filter-btn {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            background: var(--bg-primary);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
        }
        .picker-filter-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }
        .picker-filter-btn.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        .picker-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }
        .picker-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.15s;
            background: var(--bg-primary);
        }
        .picker-item:hover {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        .picker-item.selected {
            background: rgba(34, 197, 94, 0.1);
            border-color: #22c55e;
        }
        .picker-item.in-cart {
            background: rgba(34, 197, 94, 0.1);
            border-color: #22c55e;
        }
        .picker-item .region-tag {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: 600;
        }
        .picker-item .info,
        .picker-item-info {
            flex: 1;
            min-width: 0;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        .picker-item .name,
        .picker-item-name {
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: inline-flex;
            align-items: center;
        }
        .picker-item .address,
        .picker-item-address {
            font-size: 11px;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-top: 2px;
        }
        .picker-item .star {
            font-size: 14px;
        }
        /* ★ 공실 개수 뱃지 */
        .vacancy-count-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 18px;
            height: 18px;
            padding: 0 5px;
            margin-left: 6px;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            font-size: 10px;
            font-weight: 700;
            border-radius: 9px;
            vertical-align: middle;
        }
        .picker-item .add-btn {
            padding: 6px 14px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .picker-item .add-btn.add {
            background: var(--accent-color);
            color: white;
        }
        .picker-item .add-btn.remove {
            background: #fee2e2;
            color: #dc2626;
        }
        
        /* 우측: 장바구니 */
        .picker-right {
            width: 320px;
            display: flex;
            flex-direction: column;
            background: var(--bg-secondary);
        }
        .cart-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-card);
        }
        .cart-header h3 {
            font-size: 15px;
            font-weight: 600;
            margin: 0 0 12px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .cart-header .count {
            background: var(--accent-color);
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
        }
        .cart-view-tabs {
            display: flex;
            gap: 4px;
        }
        .cart-view-tab {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-primary);
            font-size: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.15s;
        }
        .cart-view-tab:hover {
            border-color: var(--accent-color);
        }
        .cart-view-tab.active {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        .cart-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }
        .cart-region-group {
            margin-bottom: 16px;
        }
        .cart-region-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            padding: 6px 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .cart-region-title .badge {
            background: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
        }
        .cart-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: var(--bg-card);
            border-radius: 8px;
            margin-bottom: 6px;
            font-size: 13px;
            border: 1px solid var(--border-color);
        }
        .cart-item .region-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        .cart-item .region-dot.gbd { background: #22c55e; }
        .cart-item .region-dot.cbd { background: #3b82f6; }
        .cart-item .region-dot.ybd { background: #8b5cf6; }
        .cart-item .region-dot.bbd { background: #f97316; }
        .cart-item .region-dot.etc { background: #6b7280; }
        .cart-item .name {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 500;
        }
        .cart-item .remove-btn {
            width: 24px;
            height: 24px;
            border: none;
            background: #fee2e2;
            color: #dc2626;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .cart-item .remove-btn:hover {
            background: #fecaca;
        }
        
        .cart-empty {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }
        .cart-empty .icon {
            font-size: 40px;
            margin-bottom: 12px;
            opacity: 0.5;
        }
        
        .cart-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            background: var(--bg-card);
        }
        .cart-summary {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 4px;
            margin-bottom: 12px;
            font-size: 11px;
            text-align: center;
        }
        .cart-summary-item {
            padding: 6px 4px;
            background: var(--bg-secondary);
            border-radius: 4px;
        }
        .cart-summary-item .region {
            font-weight: 600;
            margin-bottom: 2px;
        }
        .cart-summary-item .count {
            color: var(--accent-color);
            font-weight: 700;
        }
        .cart-actions {
            display: flex;
            gap: 8px;
        }
        .cart-actions .btn {
            flex: 1;
        }

        /* ===== 공실 선택 탭 ===== */
        .vacancy-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        .vacancy-tab {
            padding: 10px 20px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s;
        }
        .vacancy-tab:hover {
            color: var(--text-primary);
        }
        .vacancy-tab.active {
            color: var(--accent-color);
            border-bottom-color: var(--accent-color);
        }
        .vacancy-panel {
            display: none;
        }
        .vacancy-panel.active {
            display: block;
        }

        /* 직접 입력 폼 */
        .vacancy-form {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
        }
        .vacancy-form-row {
            display: grid;
            grid-template-columns: 80px 1fr 1fr 1fr 1fr auto;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .vacancy-form-row:last-child {
            margin-bottom: 0;
        }
        .vacancy-form-row input {
            padding: 8px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 13px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .vacancy-form-row input::placeholder {
            color: var(--text-muted);
        }
        .vacancy-form-row .btn-remove {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            background: #fee2e2;
            color: #dc2626;
            cursor: pointer;
            font-size: 14px;
        }
        .vacancy-form-row .btn-remove:hover {
            background: #fecaca;
        }

        /* 타사 공실 선택 모달 */
        .external-vacancy-modal {
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-top: 12px;
        }
        .external-vacancy-modal-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .external-vacancy-modal-header h4 {
            margin: 0;
            font-size: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* 검색 및 필터 영역 */
        .external-search-area {
            padding: 16px 20px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .external-search-row {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }
        .external-search-row:last-child {
            margin-bottom: 0;
        }
        .external-search-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 13px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .external-search-input::placeholder {
            color: var(--text-muted);
        }
        .external-filter-select {
            padding: 10px 14px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 13px;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-width: 140px;
        }
        
        /* 공실 목록 영역 */
        .external-vacancy-body {
            max-height: 320px;
            overflow-y: auto;
        }
        
        /* 회사/날짜 그룹 헤더 */
        .external-source-group {
            border-bottom: 1px solid var(--border-color);
        }
        .external-source-group:last-child {
            border-bottom: none;
        }
        .external-source-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: var(--bg-tertiary);
            cursor: pointer;
            user-select: none;
        }
        .external-source-header:hover {
            background: var(--bg-secondary);
        }
        .external-source-header .toggle-icon {
            font-size: 10px;
            transition: transform 0.2s;
        }
        .external-source-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        .external-source-header .source-name {
            font-weight: 600;
            font-size: 13px;
            color: var(--text-primary);
        }
        .external-source-header .source-date {
            font-size: 12px;
            color: var(--text-muted);
            background: var(--bg-primary);
            padding: 2px 8px;
            border-radius: 4px;
        }
        .external-source-header .source-count {
            margin-left: auto;
            font-size: 11px;
            color: var(--text-muted);
        }
        .external-source-header .select-all-btn {
            font-size: 11px;
            padding: 4px 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-primary);
            color: var(--text-secondary);
            cursor: pointer;
        }
        .external-source-header .select-all-btn:hover {
            background: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }
        
        /* 공실 아이템 */
        .external-vacancy-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px 12px 40px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.15s;
        }
        .external-vacancy-item:last-child {
            border-bottom: none;
        }
        .external-vacancy-item:hover {
            background: rgba(59, 130, 246, 0.05);
        }
        .external-vacancy-item.selected {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid var(--accent-color);
            padding-left: 37px;
        }
        .external-vacancy-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-color);
            flex-shrink: 0;
        }
        .external-vacancy-item .floor-badge {
            font-weight: 700;
            color: #1e3a5f;
            background: #e0e7ff;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 13px;
            min-width: 50px;
            text-align: center;
        }
        .external-vacancy-item .area-info {
            flex: 1;
            display: flex;
            gap: 16px;
            font-size: 13px;
        }
        .external-vacancy-item .area-info span {
            color: var(--text-secondary);
        }
        .external-vacancy-item .area-info .label {
            color: var(--text-muted);
            font-size: 11px;
        }
        
        /* 선택된 공실 카트 */
        .external-vacancy-cart {
            border-top: 2px solid var(--accent-color);
            background: rgba(59, 130, 246, 0.03);
        }
        .external-vacancy-cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background: rgba(59, 130, 246, 0.08);
        }
        .external-vacancy-cart-header h5 {
            margin: 0;
            font-size: 13px;
            font-weight: 600;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .external-vacancy-cart-header .count-badge {
            background: var(--accent-color);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
        }
        .external-vacancy-cart-header .cart-actions {
            display: flex;
            gap: 8px;
        }
        .external-vacancy-cart-header .cart-actions button {
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        .external-vacancy-cart-body {
            max-height: 150px;
            overflow-y: auto;
            padding: 8px 20px;
        }
        .external-cart-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: var(--bg-primary);
            border-radius: 6px;
            margin-bottom: 6px;
            font-size: 12px;
        }
        .external-cart-item:last-child {
            margin-bottom: 0;
        }
        .external-cart-item .floor {
            font-weight: 600;
            color: var(--accent-color);
        }
        .external-cart-item .info {
            flex: 1;
            color: var(--text-secondary);
        }
        .external-cart-item .source {
            font-size: 10px;
            color: var(--text-muted);
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: 3px;
        }
        .external-cart-item .remove-btn {
            width: 20px;
            height: 20px;
            border: none;
            background: #fee2e2;
            color: #ef4444;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .external-cart-item .remove-btn:hover {
            background: #ef4444;
            color: white;
        }
        
        /* 안내 메시지 */
        .external-vacancy-notice {
            padding: 12px 20px;
            background: #fef3c7;
            border-top: 1px solid #fcd34d;
            font-size: 12px;
            color: #92400e;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* 푸터 버튼 */
        .external-vacancy-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* 빈 상태 */
        .external-vacancy-empty {
            padding: 40px 20px;
            text-align: center;
            color: var(--text-muted);
        }
        .external-vacancy-empty .icon {
            font-size: 40px;
            margin-bottom: 12px;
            opacity: 0.5;
        }
        .external-vacancy-empty p {
            margin: 0 0 16px;
            font-size: 13px;
        }
        
        /* 기존 스타일 유지 */
        .external-vacancy-source {
            margin-bottom: 16px;
        }
        .external-vacancy-source select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 13px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .external-vacancy-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 10px;
        }
        .external-vacancy-item .info {
            flex: 1;
        }
        .external-vacancy-item .floor {
            font-weight: 600;
            color: var(--accent-color);
            font-size: 14px;
        }
        .external-vacancy-item .details {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }
        .external-vacancy-item .source-badge {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--text-muted);
        }

        /* 선택된 공실 리스트 */
        .selected-vacancy-list {
            margin-top: 16px;
        }
        .selected-vacancy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .selected-vacancy-header .title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .selected-vacancy-header .count {
            font-size: 12px;
            color: var(--accent-color);
        }
        .selected-vacancy-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .selected-vacancy-table th {
            text-align: left;
            padding: 10px 8px;
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .selected-vacancy-table td {
            padding: 10px 8px;
            border-bottom: 1px solid var(--border-color);
        }
        .selected-vacancy-table tr:last-child td {
            border-bottom: none;
        }
        .selected-vacancy-table .floor {
            font-weight: 600;
            color: var(--accent-color);
        }
        .selected-vacancy-table .source {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            background: var(--bg-secondary);
        }
        .selected-vacancy-table .btn-remove {
            background: none;
            border: none;
            color: #dc2626;
            cursor: pointer;
            font-size: 14px;
        }

        .edit-main {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: var(--bg-secondary);
        }
        .editor-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
        }
        .editor-empty .icon { font-size: 48px; margin-bottom: 16px; }

        /* ===== 빌딩 에디터 ===== */
        .building-editor {
            background: var(--bg-card);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .building-editor-header {
            background: linear-gradient(135deg, var(--accent-color), #60a5fa);
            color: white;
            padding: 20px 24px;
        }
        .building-editor-title {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        .building-editor-title h3 {
            font-size: 20px;
            font-weight: 700;
            margin: 0;
        }
        .building-editor-address {
            margin-top: 8px;
            font-size: 14px;
            opacity: 0.9;
        }

        /* 권역 태그 */
        .region-tag {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
            background: rgba(255,255,255,0.25);
        }
        .region-tag.gbd { background: #fef3c7; color: #92400e; }
        .region-tag.cbd { background: #dbeafe; color: #1e40af; }
        .region-tag.ybd { background: #d1fae5; color: #065f46; }
        .region-tag.bbd { background: #ede9fe; color: #5b21b6; }
        .region-tag.etc { background: #f1f5f9; color: #475569; }

        /* 마감 뱃지 */
        .close-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .close-badge.confirmed {
            background: rgba(34, 197, 94, 0.2);
            color: #dcfce7;
        }
        .close-badge.pending {
            background: rgba(251, 191, 36, 0.2);
            color: #fef3c7;
        }

        .editor-section {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
        }
        .editor-section:last-child {
            border-bottom: none;
        }
        .editor-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .editor-section-title .sub {
            font-weight: 400;
            color: var(--text-muted);
            font-size: 12px;
        }

        /* 이미지 그리드 */
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 12px;
        }
        .image-item {
            aspect-ratio: 4/3;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            background: var(--bg-tertiary);
        }
        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .image-item.image-add {
            border: 2px dashed var(--border-color);
            background: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-muted);
            font-size: 12px;
        }
        .image-item.image-add:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        .image-item.image-add .icon {
            font-size: 20px;
        }

        /* 정보 그리드 */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        .info-grid > div {
            background: var(--bg-secondary);
            padding: 12px 14px;
            border-radius: 8px;
        }
        .info-grid .label {
            font-size: 12px;
            color: var(--text-muted);
        }
        .info-grid .value {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-left: 4px;
        }

        /* 공실 리스트 */
        .vacancy-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .vacancy-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .vacancy-item.checked {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--accent-color);
        }
        .vacancy-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-color);
            cursor: pointer;
        }
        .vacancy-item .floor {
            font-weight: 600;
            color: var(--accent-color);
            min-width: 40px;
        }
        .vacancy-item .area {
            color: var(--text-secondary);
            font-size: 13px;
            min-width: 60px;
        }
        .vacancy-item .price {
            margin-left: auto;
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* TOC 아이템 추가 스타일 */
        .toc-item.cover {
            background: linear-gradient(135deg, var(--accent-color), #60a5fa);
            color: white;
        }
        .toc-item.cover:hover {
            background: linear-gradient(135deg, var(--accent-hover), #3b82f6);
        }
        .toc-item .region-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        .toc-item .region-badge.gbd { background: #fef3c7; color: #92400e; }
        .toc-item .region-badge.cbd { background: #dbeafe; color: #1e40af; }
        .toc-item .region-badge.ybd { background: #d1fae5; color: #065f46; }
        .toc-item .region-badge.bbd { background: #ede9fe; color: #5b21b6; }
        .toc-item .region-badge.etc { background: #f1f5f9; color: #475569; }
        .toc-item.active .region-badge {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        /* ===== 모달 ===== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-overlay.show { display: flex; }
        .modal {
            background: var(--bg-card);
            border-radius: 16px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
        }
        .modal-title { font-size: 18px; font-weight: 600; }
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
        }
        .modal-body {
            padding: 24px;
            overflow-y: auto;
            flex: 1;
        }
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
        }

        /* ===== 폼 ===== */
        .form-group {
            margin-bottom: 16px;
        }
        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }
        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        .required { color: var(--error-color); }

        /* ===== 옵션 카드 ===== */
        .option-cards {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }
        .option-card {
            flex: 1;
            padding: 20px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .option-card:hover { border-color: var(--accent-color); }
        .option-card.selected {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.1);
        }
        .option-card .icon { font-size: 28px; margin-bottom: 8px; }
        .option-card .label { font-weight: 500; }

        /* ===== 빌딩 리스트 (모달) ===== */
        .building-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
        }
        .building-item:hover { background: var(--bg-secondary); }
        .building-item.selected { background: rgba(59, 130, 246, 0.1); }
        .building-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }
        .building-item .info { flex: 1; }
        .building-item .name { font-weight: 500; font-size: 14px; }
        .building-item .address { font-size: 12px; color: var(--text-muted); }
        .building-item .badge {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 4px;
            background: var(--bg-tertiary);
        }

        /* ===== 로딩 ===== */
        .loading {
            display: flex;
            justify-content: center;
            padding: 40px;
        }
        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ===== 토스트 ===== */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .toast {
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            animation: slideIn 0.3s ease;
        }
        .toast.success { background: var(--success-color); color: white; }
        .toast.error { background: var(--error-color); color: white; }
        .toast.info { background: var(--accent-color); color: white; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ===== 빈 상태 ===== */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }
        .empty-state .icon { font-size: 48px; margin-bottom: 16px; }

        /* ===== 반응형 ===== */
        @media (max-width: 768px) {
            .page-header { flex-direction: column; gap: 16px; }
            .filter-bar { flex-direction: column; align-items: stretch; }
            .edit-body { flex-direction: column; }
            .edit-sidebar { width: 100%; height: 200px; border-right: none; border-bottom: 1px solid var(--border-color); }
        }

        /* ===== 전체 미리보기 모달 (JS 호환용) ===== */
        .fullpreview-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .fullpreview-overlay.show {
            display: flex;
        }
        .fullpreview-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-width: 1100px;
        }
        .fullpreview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            background: rgba(0,0,0,0.5);
            border-radius: 8px 8px 0 0;
        }
        .fullpreview-title {
            color: white;
            font-size: 16px;
            font-weight: 600;
        }
        .fullpreview-close {
            font-size: 28px;
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.7;
            padding: 4px 12px;
        }
        .fullpreview-close:hover {
            opacity: 1;
        }
        .fullpreview-content {
            flex: 1;
            background: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            aspect-ratio: 297 / 210;
            width: calc((100vh - 180px) * 297 / 210);
            max-width: calc(100vw - 80px);
            height: auto;
            margin: 0 auto;
        }
        .fullpreview-footer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 16px 24px;
            background: rgba(0,0,0,0.5);
            border-radius: 0 0 8px 8px;
        }
        .fullpreview-nav-btn {
            padding: 10px 24px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .fullpreview-nav-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.3);
        }
        .fullpreview-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .fullpreview-pagination {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 14px;
        }
        .page-dots {
            display: flex;
            gap: 6px;
        }
        .page-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            cursor: pointer;
            transition: all 0.2s;
        }
        .page-dot.active {
            background: white;
            transform: scale(1.2);
        }
        .page-dot:hover {
            background: rgba(255,255,255,0.6);
        }

        /* ===== 미리보기 페이지 공통 ===== */
        .fullpreview-cover,
        .fullpreview-toc-full,
        .fullpreview-toc-region,
        .fullpreview-building,
        .fullpreview-divider {
            width: 100%;
            height: 100%;
        }

        /* ===== 표지 미리보기 개선 ===== */
        .fullpreview-cover {
            background: linear-gradient(135deg, #1a1f2e 0%, #2d3748 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px;
            position: relative;
            overflow: hidden;
        }
        .fullpreview-cover .cover-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
        }
        .fullpreview-cover .cover-bg .skyline {
            width: 100%;
            height: 100%;
        }
        .fullpreview-cover .cover-content {
            position: relative;
            z-index: 1;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        /* ===== 빌딩 페이지 미리보기 ===== */
        .fullpreview-building {
            background: white;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        .fullpreview-building-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 12px;
            border-bottom: 2px solid #1e3a5f;
            margin-bottom: 16px;
        }
        .fullpreview-building-title {
            font-size: 22px;
            font-weight: 700;
            color: #1e3a5f;
        }
        .fullpreview-region {
            font-size: 14px;
            color: #64748b;
        }
        .fullpreview-building-body {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1.2fr 1.3fr;
            gap: 16px;
        }
        .fullpreview-col-left,
        .fullpreview-col-center,
        .fullpreview-col-right {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .fullpreview-col-left {
            border-right: 1px solid #e5e7eb;
            padding-right: 16px;
        }
        .fullpreview-col-center {
            border-right: 1px solid #e5e7eb;
            padding-right: 16px;
        }

        /* ===== 간지 미리보기 ===== */
        .fullpreview-divider {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 60px;
        }
        .fullpreview-divider .divider-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .fullpreview-divider .divider-content {
            font-size: 18px;
            line-height: 1.6;
            max-width: 600px;
        }

        /* ===== 권역 배지 (전역) ===== */
        .region-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        .region-badge.region-GBD, .region-tag.region-GBD { background: #dcfce7; color: #166534; }
        .region-badge.region-CBD, .region-tag.region-CBD { background: #dbeafe; color: #1e40af; }
        .region-badge.region-YBD, .region-tag.region-YBD { background: #ede9fe; color: #5b21b6; }
        .region-badge.region-BBD, .region-tag.region-BBD { background: #fee2e2; color: #991b1b; }
        .region-badge.region-PAN, .region-tag.region-PAN { background: #fef3c7; color: #92400e; }
        .region-badge.region-ETC, .region-tag.region-ETC { background: #f1f5f9; color: #475569; }
        /* 커스텀 권역 (리테일, 지방 등) - 기본 스타일 */
        .region-badge[class*="region-"], .region-tag[class*="region-"] {
            background: #f0f9ff; color: #0369a1;
        }
        /* 리테일 권역 */
        .region-badge.region-CBD-R, .region-tag.region-CBD-R,
        .region-badge.region-GBD-R, .region-tag.region-GBD-R,
        .region-badge.region-YBD-R, .region-tag.region-YBD-R,
        .region-badge.region-RETAIL, .region-tag.region-RETAIL { 
            background: #fdf2f8; color: #9d174d; 
        }
        /* 경기 권역 */
        .region-badge.region-GSW, .region-tag.region-GSW,
        .region-badge.region-GGN, .region-tag.region-GGN,
        .region-badge.region-GGB, .region-tag.region-GGB { 
            background: #ecfdf5; color: #047857; 
        }
        /* 지방 권역 */
        .region-badge.region-ICN, .region-tag.region-ICN,
        .region-badge.region-BSN, .region-tag.region-BSN,
        .region-badge.region-DGU, .region-tag.region-DGU,
        .region-badge.region-GJU, .region-tag.region-GJU { 
            background: #fff7ed; color: #c2410c; 
        }

        /* ===== 타사 공실 그룹 ===== */
        .external-vacancy-container {
            display: grid;
            grid-template-columns: 1fr 240px;
            gap: 12px;
            padding: 12px;
        }
        .external-vacancy-list {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }
        .external-vacancy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .external-vacancy-filters {
            display: flex;
            gap: 6px;
        }
        .external-vacancy-filters select {
            padding: 4px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 11px;
            background: var(--bg-primary);
        }
        .external-vacancy-body {
            max-height: 420px;
            overflow-y: auto;
        }
        .external-vacancy-group {
            border-bottom: 1px solid var(--border-color);
        }
        .external-vacancy-group:last-child {
            border-bottom: none;
        }
        .external-vacancy-group-header {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-tertiary);
            cursor: pointer;
            transition: background 0.2s;
        }
        .external-vacancy-group-header:hover {
            background: var(--border-color);
        }
        .external-vacancy-group-header .group-toggle {
            font-size: 9px;
            color: var(--text-muted);
            transition: transform 0.2s;
        }
        .external-vacancy-group.collapsed .group-toggle {
            transform: rotate(-90deg);
        }
        .external-vacancy-group.collapsed .external-vacancy-group-body {
            display: none;
        }
        .external-vacancy-group-header .group-source {
            font-weight: 600;
            font-size: 11px;
        }
        .external-vacancy-group-header .group-date {
            font-size: 10px;
            color: var(--text-muted);
        }
        .external-vacancy-group-header .group-count {
            font-size: 10px;
            color: var(--accent-color);
            margin-left: auto;
            margin-right: 6px;
        }
        .external-vacancy-group-body {
            background: var(--bg-primary);
        }
        .external-vacancy-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px 6px 24px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.15s;
            font-size: 11px;
        }
        .external-vacancy-item:last-child {
            border-bottom: none;
        }
        .external-vacancy-item:hover {
            background: rgba(59, 130, 246, 0.05);
        }
        .external-vacancy-item.selected {
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid var(--accent-color);
            padding-left: 21px;
        }
        .external-vacancy-item .vacancy-check {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: var(--accent-color);
            background: var(--bg-primary);
        }
        .external-vacancy-item.selected .vacancy-check {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }
        .external-vacancy-item .vacancy-floor {
            font-weight: 700;
            color: #1e3a5f;
            min-width: 32px;
            font-size: 11px;
        }
        .external-vacancy-item .vacancy-area {
            color: var(--text-secondary);
            font-size: 11px;
        }
        .external-vacancy-item .vacancy-price {
            color: var(--text-muted);
            font-size: 10px;
            margin-left: auto;
        }
        .external-vacancy-cart {
            border: 1px solid var(--accent-color);
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .external-vacancy-cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 10px;
            background: rgba(59, 130, 246, 0.1);
            border-bottom: 1px solid var(--accent-color);
        }
        .external-vacancy-cart-header h5 {
            margin: 0;
            font-size: 11px;
            font-weight: 600;
        }
        .external-vacancy-cart-body {
            flex: 1;
            padding: 6px;
            max-height: 350px;
            overflow-y: auto;
        }
        .external-vacancy-cart .cart-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 5px 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            margin-bottom: 4px;
            font-size: 10px;
        }
        .external-vacancy-cart .cart-item:last-child {
            margin-bottom: 0;
        }
        .external-vacancy-cart .cart-item-info {
            flex: 1;
            display: flex;
            gap: 6px;
            align-items: center;
        }
        .external-vacancy-cart .cart-floor {
            font-weight: 700;
            color: #1e3a5f;
            font-size: 10px;
        }
        .external-vacancy-cart .cart-area {
            color: var(--text-secondary);
            font-size: 10px;
        }
        .external-vacancy-cart .cart-source {
            font-size: 9px;
            color: var(--text-muted);
        }
        .external-vacancy-cart .cart-remove {
            width: 16px;
            height: 16px;
            border: none;
            background: #fee2e2;
            color: #dc2626;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }
        .external-vacancy-notice {
            grid-column: span 2;
            padding: 8px 10px;
            background: #fef3c7;
            border-radius: 6px;
            font-size: 11px;
            color: #92400e;
        }

        /* ===== 공실 추가 패널 ===== */
        .vacancy-add-panel {
            margin-top: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }
        .vacancy-add-tabs {
            display: flex;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }
        .vacancy-add-tab {
            flex: 1;
            padding: 8px;
            border: none;
            background: none;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            color: var(--text-muted);
            transition: all 0.2s;
        }
        .vacancy-add-tab.active {
            color: var(--accent-color);
            background: var(--bg-primary);
            border-bottom: 2px solid var(--accent-color);
        }
        .vacancy-add-content {
            padding: 12px;
        }
        .vacancy-add-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 6px;
            align-items: center;
        }
        .vacancy-add-grid input {
            padding: 6px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 11px;
        }
        .vacancy-add-grid button {
            grid-column: span 1;
        }

        /* ===== 공실 테이블 ===== */
        .vacancy-list-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-top: 12px;
        }
        .vacancy-list-table th {
            background: #1e3a5f;
            color: white;
            padding: 8px 6px;
            text-align: center;
            font-weight: 600;
            font-size: 11px;
        }
        .vacancy-list-table td {
            padding: 6px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }
        .vacancy-list-table .floor {
            font-weight: 700;
            color: #1e3a5f;
        }
        .vacancy-list-table .actions {
            display: flex;
            gap: 4px;
            justify-content: center;
        }

        /* ===== 컨택포인트 모달 ===== */
        .cp-modal-content {
            padding: 16px;
        }
        .cp-building-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 16px;
        }
        .cp-building-name {
            font-weight: 600;
            font-size: 15px;
        }
        .cp-add-dropdown {
            display: flex;
            gap: 8px;
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 16px;
        }
        .cp-add-dropdown select {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }
        .cp-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .cp-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        .cp-item-info {
            display: flex;
            gap: 16px;
            align-items: center;
        }
        .cp-item-info .cp-name {
            font-weight: 600;
        }
        .cp-item-info .cp-position {
            color: var(--text-muted);
            font-size: 12px;
        }
        .cp-item-info .cp-phone {
            color: var(--text-secondary);
            font-size: 13px;
        }
        .cp-item-info .cp-email {
            color: var(--text-muted);
            font-size: 12px;
        }
        .cp-item-actions {
            display: flex;
            gap: 4px;
        }
        .btn-xs {
            padding: 4px 8px;
            font-size: 11px;
        }
        .btn-danger {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        .btn-danger:hover {
            background: #fecaca;
        }

        /* ===== 일괄 매핑 ===== */
        .bulk-mapping-container {
            padding: 16px;
        }
        .bulk-user-select {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 16px;
        }
        .bulk-user-select label {
            font-weight: 500;
            font-size: 13px;
        }
        .bulk-user-select select {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }
        .bulk-mapping-area {
            min-height: 100px;
            margin-bottom: 16px;
        }
        .bulk-guide-buildings label {
            display: block;
            font-weight: 500;
            font-size: 13px;
            margin-bottom: 8px;
        }
        .building-chip-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-height: 200px;
            overflow-y: auto;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 12px;
        }
        .building-chip {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            font-size: 12px;
        }
        .building-chip input {
            margin: 0;
        }
        .bulk-actions {
            display: flex;
            gap: 8px;
        }

        /* ===== 권역 선택 드롭다운 ===== */
        .region-select-btn {
            padding: 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-secondary);
            font-size: 12px;
            cursor: pointer;
            color: var(--text-primary);
        }
        .region-select-btn:hover {
            border-color: var(--accent-color);
        }
        .region-select-btn:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        /* ===== 엔딩 페이지 (THANK YOU) - v4.0 편집/미리보기/인쇄 통일 ===== */
        .fullpreview-ending {
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: 50% 50%;
            background: linear-gradient(135deg, #1a1f2e 0%, #2d3748 100%);
            overflow: hidden;
        }
        .ending-left {
            padding: 50px 40px 50px 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .ending-headlines {
            margin-bottom: 20px;
        }
        .ending-headline {
            font-size: 20px;
            font-weight: 500;
            color: #fbbf24;
            line-height: 1.5;
        }
        .ending-company {
            font-size: 26px;
            font-weight: 700;
            color: #ffffff;
            margin-top: 8px;
        }
        .ending-descriptions {
            margin-bottom: 30px;
        }
        .ending-descriptions p {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            margin: 0 0 3px 0;
        }
        .ending-thankyou {
            font-size: 42px;
            font-weight: 700;
            color: #ec4899;
            letter-spacing: 3px;
            margin-bottom: 8px;
        }
        .ending-closing {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 30px;
        }
        .ending-logo-area {
            margin-bottom: 16px;
        }
        .ending-logo {
            max-height: 36px;
            object-fit: contain;
            filter: brightness(0) invert(1);
        }
        .ending-logo-placeholder {
            font-size: 18px;
            font-weight: 700;
            color: #ffffff;
        }
        .ending-slogan {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }
        .ending-right {
            background: transparent;
            padding: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .ending-image-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 380px;
            height: 90%;
        }
        .ending-img-placeholder {
            aspect-ratio: 4/3;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        .ending-img-cell {
            border-radius: 6px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        .ending-img-cell img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .ending-img-empty {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        }

        /* ===== 엔딩 에디터 모달 ===== */
        .ending-editor-grid {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        .ending-editor-grid .setting-row {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .ending-editor-grid .setting-row label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            cursor: pointer;
        }
        .ending-editor-grid .setting-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .ending-editor-grid .setting-group label {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
        }
        .ending-editor-grid .setting-group input[type="text"] {
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 13px;
        }

        /* ===== 권역 관리 모달 ===== */
        .region-section {
            margin-bottom: 20px;
        }
        .region-section h4 {
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 12px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .region-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .region-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: 13px;
            transition: all 0.2s;
        }
        .region-item.default {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
        }
        .region-item.default.has-alias {
            background: #fef3c7;
            border: 1px solid #fcd34d;
        }
        .region-item.custom {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
        }
        .region-item .region-code {
            font-weight: 700;
            min-width: 50px;
            color: var(--accent-color);
            font-size: 14px;
        }
        .region-item .region-name {
            font-weight: 500;
        }
        .region-item .region-name-en {
            color: var(--text-muted);
            font-size: 12px;
        }
        .region-item .region-lock {
            color: var(--text-muted);
            font-size: 14px;
        }
        .region-add-form {
            margin-top: 16px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }
        .region-add-form h4 {
            margin: 0 0 12px 0;
            font-size: 14px;
        }
        .region-add-form label {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 4px;
            display: block;
        }
        .region-add-form input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 13px;
        }
        .region-examples {
            margin-top: 20px;
            padding: 16px;
            background: #fefce8;
            border-radius: 8px;
        }
        .region-examples h4 {
            margin: 0 0 12px 0;
            font-size: 13px;
            color: #854d0e;
        }
        .example-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .example-chip {
            padding: 6px 12px;
            background: white;
            border: 1px solid #fde68a;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .example-chip:hover {
            background: #fef3c7;
            border-color: #f59e0b;
        }

        /* ===== 엔딩 에디터 이미지 ===== */
        .ending-images-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }
        .ending-image-slot {
            aspect-ratio: 4/3;
            border: 2px dashed var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            overflow: hidden;
            position: relative;
            transition: all 0.2s;
        }
        .ending-image-slot:hover {
            border-color: var(--accent-color);
            background: rgba(59, 130, 246, 0.05);
        }
        .ending-image-slot.has-image {
            border-style: solid;
            border-color: var(--border-color);
        }
        .ending-image-slot img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .ending-image-slot .placeholder {
            font-size: 20px;
            color: var(--text-muted);
        }
        .ending-image-slot .remove-btn {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 16px;
            height: 16px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .ending-preview {
            width: 100%;
        }

        /* ===== v5.0: 공실 개수 표시 ===== */
        .vacancy-count-info {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            margin-right: auto;
            margin-left: 12px;
        }
        .vacancy-current-count {
            font-weight: 700;
            color: var(--accent-color);
        }
        .vacancy-current-count.over-limit {
            color: #ef4444;
        }
        .vacancy-max-count {
            color: var(--text-secondary);
        }
        .vacancy-limit-hint {
            color: var(--text-muted);
            font-size: 10px;
        }
        .vacancy-warning {
            background: #fef3c7;
            color: #92400e;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            margin-bottom: 12px;
            border: 1px solid #fcd34d;
        }

        /* ===== 유틸리티 ===== */
        .hidden { display: none !important; }

        /* ===== v5.0: 인쇄 비활성화 (출력은 별도 페이지에서) ===== */
        @media print {
            body::before {
                content: '⚠️ 인쇄는 출력 페이지에서 진행해주세요. 플로팅 메뉴의 [출력] 또는 [전체] 버튼을 클릭하세요.';
                display: block;
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #fef3c7;
                color: #92400e;
                padding: 30px 50px;
                border-radius: 12px;
                font-size: 16px;
                font-weight: 600;
                text-align: center;
                z-index: 99999;
                box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            }
            
            body > * {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- 헤더 -->
    <header class="header">
        <a href="portal.html" class="header-logo">
            <span>🏢</span> CRE PORTAL
        </a>
        <span class="header-title">📄 임대안내문 관리</span>
        <div class="header-right">
            <a href="portal.html" class="back-btn">← 포털로 돌아가기</a>
            <button class="theme-btn" onclick="toggleTheme()" title="다크모드">🌙</button>
            <div class="user-badge" id="userBadge">
                <span id="userName">로딩중...</span>
                <span class="role" id="userRole">-</span>
            </div>
        </div>
    </header>

    <!-- 리스트 페이지 -->
    <div class="list-container" id="listContainer">
        <div class="main-container">
            <div class="page-header">
                <div>
                    <h1>📄 임대안내문 관리</h1>
                    <p class="subtitle">임대안내문을 생성, 편집, 관리할 수 있습니다</p>
                </div>
                <button class="btn btn-primary btn-lg" onclick="openCreateModal()">
                    ➕ 새 안내문 만들기
                </button>
            </div>

            <div class="filter-bar">
                <div class="filter-group">
                    <label>발행월</label>
                    <select id="filterMonth">
                        <option value="">전체</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>상태</label>
                    <select id="filterStatus">
                        <option value="">전체</option>
                        <option value="draft">작성중</option>
                        <option value="published">발행완료</option>
                        <option value="closed">마감</option>
                    </select>
                </div>
                <div class="filter-group" id="filterCreatorGroup">
                    <label>생성자</label>
                    <select id="filterCreator">
                        <option value="">전체</option>
                    </select>
                </div>
            </div>

            <div class="guide-list" id="guideList">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
    </div>

    <!-- 편집 페이지 -->
    <div class="edit-container" id="editContainer">
        <div class="edit-header">
            <div class="edit-header-left">
                <button class="btn btn-secondary" onclick="closeEditor()">← 목록</button>
                <input type="text" class="edit-title-input" id="editTitle" placeholder="임대안내문 제목 입력">
                <div class="edit-meta">
                    <span class="status-badge draft" id="editStatus">작성중</span>
                    <span id="editMeta">발행: -</span>
                </div>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn btn-secondary" onclick="saveDraft()">💾 임시저장</button>
                <button class="btn btn-primary" onclick="saveFinal()">✅ 최종저장</button>
            </div>
        </div>

        <div class="edit-body">
            <!-- 사이드바 -->
            <div class="edit-sidebar">
                <div class="sidebar-header">
                    <h3>📑 목차</h3>
                    <div class="sidebar-actions">
                        <button class="btn btn-sm btn-secondary" onclick="openAddBuildingModal()">+ 빌딩</button>
                        <button class="btn btn-sm btn-secondary" onclick="addDivider()">+ 간지</button>
                    </div>
                </div>
                <div class="sidebar-content" id="tocList">
                    <!-- 목차 아이템들 -->
                </div>
                <div class="sidebar-footer">
                    <div style="font-size:12px; font-weight:600; color:var(--text-muted); margin-bottom:10px;">📊 권역별 현황</div>
                    <div class="summary-grid" id="summaryGrid">
                        <!-- 요약 -->
                    </div>
                </div>
            </div>

            <!-- 메인 에디터 -->
            <div class="edit-main" id="editorMain">
                <div class="editor-empty">
                    <div class="icon">📋</div>
                    <p>좌측 목차에서 편집할 항목을 선택하세요</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 생성 모달 -->
    <div class="modal-overlay" id="createModal" onclick="if(event.target===this)closeCreateModal()">
        <div class="modal" style="position:relative; transform:none; top:auto; left:auto;">
            <div class="modal-header">
                <h2 class="modal-title">📄 새 임대안내문 만들기</h2>
                <button class="modal-close" onclick="closeCreateModal()">×</button>
            </div>
            <div class="modal-body" style="padding:20px;">
                <div class="option-cards">
                    <div class="option-card selected" data-type="new" onclick="selectCreateType('new')">
                        <div class="icon">📝</div>
                        <div class="label">새로 만들기</div>
                    </div>
                    <div class="option-card" data-type="prev" onclick="selectCreateType('prev')">
                        <div class="icon">📋</div>
                        <div class="label">이전호 재활용</div>
                    </div>
                </div>

                <div class="form-group" id="prevGuideGroup" style="display:none;">
                    <label>재활용할 안내문</label>
                    <select id="prevGuideSelect" style="width:100%; padding:10px; border:1px solid var(--border-color); border-radius:6px;">
                        <option value="">-- 선택하세요 --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>제목 <span class="required">*</span></label>
                    <input type="text" id="createTitle" placeholder="예: 2025년 1월호 오피스 임대안내문">
                </div>

                <div style="display:flex; gap:12px;">
                    <div class="form-group" style="flex:1;">
                        <label>발행연도</label>
                        <select id="createYear" style="width:100%; padding:10px; border:1px solid var(--border-color); border-radius:6px;"></select>
                    </div>
                    <div class="form-group" style="flex:1;">
                        <label>발행월</label>
                        <select id="createMonth" style="width:100%; padding:10px; border:1px solid var(--border-color); border-radius:6px;"></select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCreateModal()">취소</button>
                <button class="btn btn-primary" onclick="createGuide()">만들기</button>
            </div>
        </div>
    </div>

    <!-- 빌딩 추가 모달 (장바구니 형태) -->
    <div class="modal-overlay" id="addBuildingModal" onclick="if(event.target===this)closeAddBuildingModal()">
        <div class="building-picker-modal">
            <!-- 좌측: 검색 및 빌딩 목록 -->
            <div class="picker-left">
                <div class="picker-search">
                    <input type="text" id="buildingSearch" placeholder="🔍 빌딩명 또는 주소로 검색..." oninput="filterBuildingList()">
                    <div class="picker-filters">
                        <button class="picker-filter-btn active" data-region="all" onclick="filterByRegion('all')">전체</button>
                        <button class="picker-filter-btn" data-region="GBD" onclick="filterByRegion('GBD')">GBD</button>
                        <button class="picker-filter-btn" data-region="CBD" onclick="filterByRegion('CBD')">CBD</button>
                        <button class="picker-filter-btn" data-region="YBD" onclick="filterByRegion('YBD')">YBD</button>
                        <button class="picker-filter-btn" data-region="BBD" onclick="filterByRegion('BBD')">BBD</button>
                        <button class="picker-filter-btn" data-region="ETC" onclick="filterByRegion('ETC')">기타</button>
                        <button class="picker-filter-btn" data-region="starred" onclick="filterByRegion('starred')">⭐ 즐겨찾기</button>
                    </div>
                </div>
                <div class="picker-list" id="buildingList">
                    <div class="loading"><div class="spinner"></div></div>
                </div>
            </div>
            
            <!-- 우측: 장바구니 -->
            <div class="picker-right">
                <div class="cart-header">
                    <h3>🛒 담은 빌딩 <span class="count" id="cartCount">0</span></h3>
                    <div class="cart-view-tabs">
                        <button class="cart-view-tab active" onclick="setCartViewMode('all')">전체보기</button>
                        <button class="cart-view-tab" onclick="setCartViewMode('region')">권역별</button>
                    </div>
                </div>
                <div class="cart-list" id="cartList">
                    <div class="cart-empty">
                        <div class="icon">🏢</div>
                        <div>좌측에서 빌딩을 선택하세요</div>
                    </div>
                </div>
                <div class="cart-footer">
                    <div class="cart-summary" id="cartSummary">
                        <div class="cart-summary-item"><div class="region">GBD</div><div class="count">0</div></div>
                        <div class="cart-summary-item"><div class="region">CBD</div><div class="count">0</div></div>
                        <div class="cart-summary-item"><div class="region">YBD</div><div class="count">0</div></div>
                        <div class="cart-summary-item"><div class="region">BBD</div><div class="count">0</div></div>
                        <div class="cart-summary-item"><div class="region">ETC</div><div class="count">0</div></div>
                    </div>
                    <div class="cart-actions">
                        <button class="btn btn-secondary" onclick="closeAddBuildingModal()">취소</button>
                        <button class="btn btn-primary" onclick="confirmAddBuildings()">추가하기</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 컨택포인트 관리 모달 -->
    <div class="modal-overlay" id="contactPointModal" onclick="if(event.target===this)closeContactPointModal()">
        <div class="modal" style="position:relative; transform:none; top:auto; left:auto; max-width:700px; max-height:85vh;">
            <div class="modal-header" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%); color:white;">
                <h2 class="modal-title">👤 담당자 관리</h2>
                <button class="modal-close" onclick="closeContactPointModal()" style="color:white;">×</button>
            </div>
            <div class="modal-body" style="padding:0;">
                <!-- 탭 -->
                <div style="display:flex; border-bottom:1px solid var(--border-color);">
                    <button class="cp-tab active" onclick="switchCpTab('building')" data-tab="building">🏢 빌딩별 담당자</button>
                    <button class="cp-tab" onclick="switchCpTab('user')" data-tab="user">👤 담당자별 빌딩</button>
                    <button class="cp-tab" onclick="switchCpTab('bulk')" data-tab="bulk">📋 일괄 매핑</button>
                </div>
                
                <!-- 빌딩별 담당자 탭 -->
                <div class="cp-panel" id="cpPanelBuilding">
                    <div style="padding:16px; background:var(--bg-secondary);">
                        <div style="font-size:14px; font-weight:600; margin-bottom:4px;" id="cpBuildingName">빌딩명</div>
                        <div style="font-size:12px; color:var(--text-muted);">이 빌딩의 담당자를 설정합니다 (최대 4명)</div>
                    </div>
                    <div style="padding:16px;" id="cpBuildingContacts">
                        <!-- 담당자 슬롯 -->
                    </div>
                </div>
                
                <!-- 담당자별 빌딩 탭 -->
                <div class="cp-panel" id="cpPanelUser" style="display:none;">
                    <div style="padding:16px; background:var(--bg-secondary);">
                        <select id="cpUserSelect" style="width:100%; padding:10px 12px; border:1px solid var(--border-color); border-radius:8px; font-size:14px;" onchange="loadUserBuildings()">
                            <option value="">-- 담당자 선택 --</option>
                        </select>
                    </div>
                    <div style="padding:16px;" id="cpUserBuildings">
                        <div style="text-align:center; color:var(--text-muted); padding:40px;">담당자를 선택하세요</div>
                    </div>
                </div>
                
                <!-- 일괄 매핑 탭 -->
                <div class="cp-panel" id="cpPanelBulk" style="display:none;">
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px; padding:16px;">
                        <!-- 빌딩 선택 -->
                        <div>
                            <div style="font-size:12px; font-weight:600; margin-bottom:8px;">🏢 빌딩 선택 (복수 가능)</div>
                            <div style="max-height:300px; overflow-y:auto; border:1px solid var(--border-color); border-radius:8px;" id="cpBulkBuildingList">
                                <!-- 빌딩 체크박스 목록 -->
                            </div>
                            <div style="margin-top:8px; font-size:11px; color:var(--text-muted);"><span id="cpBulkBuildingCount">0</span>개 선택됨</div>
                        </div>
                        <!-- 담당자 선택 -->
                        <div>
                            <div style="font-size:12px; font-weight:600; margin-bottom:8px;">👤 담당자 선택 (복수 가능)</div>
                            <div style="max-height:300px; overflow-y:auto; border:1px solid var(--border-color); border-radius:8px;" id="cpBulkUserList">
                                <!-- 담당자 체크박스 목록 -->
                            </div>
                            <div style="margin-top:8px; font-size:11px; color:var(--text-muted);"><span id="cpBulkUserCount">0</span>명 선택됨</div>
                        </div>
                    </div>
                    <div style="padding:0 16px 16px;">
                        <div style="display:flex; gap:8px;">
                            <button class="btn btn-primary" onclick="applyBulkMapping()" style="flex:1;">✅ 선택한 빌딩에 담당자 추가</button>
                            <button class="btn btn-danger" onclick="removeBulkMapping()">🗑️ 제거</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display:flex; justify-content:space-between;">
                <div style="font-size:12px; color:var(--text-muted);">💡 변경사항은 저장 버튼을 눌러야 적용됩니다</div>
                <div style="display:flex; gap:8px;">
                    <button class="btn btn-secondary" onclick="closeContactPointModal()">취소</button>
                    <button class="btn btn-primary" onclick="saveContactPointChanges()">💾 저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ★ v4.3: 담당자 변경 모달 (빌딩별) -->
    <div class="modal-overlay" id="contactChangeModal" onclick="if(event.target===this)closeContactChangeModal()">
        <div class="modal contact-change-modal" style="position:relative; transform:none; top:auto; left:auto;">
            <div class="modal-header">
                <h2 class="modal-title">👤 담당자 변경</h2>
                <button class="modal-close" onclick="closeContactChangeModal()">×</button>
            </div>
            <div class="modal-body" style="padding:0;">
                <!-- 현재 빌딩 정보 -->
                <div style="padding:16px; background:var(--bg-secondary); border-bottom:1px solid var(--border-color);">
                    <div style="font-size:14px; font-weight:600;" id="contactChangeBuildingName">빌딩명</div>
                    <div style="font-size:12px; color:var(--text-muted); margin-top:4px;">이 빌딩의 임대안내문 담당자를 변경합니다</div>
                </div>
                
                <!-- 탭 -->
                <div class="contact-change-tabs">
                    <button class="contact-change-tab active" onclick="switchContactChangeTab('default')" data-tab="default">🏷️ 기본 담당자</button>
                    <button class="contact-change-tab" onclick="switchContactChangeTab('sni')" data-tab="sni">👥 S&I 담당자</button>
                    <button class="contact-change-tab" onclick="switchContactChangeTab('custom')" data-tab="custom">✏️ 직접 입력</button>
                </div>
                
                <!-- 현재 선택된 담당자 표시 -->
                <div class="contact-current-info" style="margin:16px; margin-bottom:0;">
                    <div class="label">📋 현재 선택된 담당자 (최대 4명)</div>
                    <div class="contact-current-list" id="contactCurrentList">
                        <span style="color:var(--text-muted); font-size:12px;">선택된 담당자가 없습니다</span>
                    </div>
                </div>
                
                <!-- 기본 담당자 탭 -->
                <div class="contact-change-panel" id="contactPanelDefault">
                    <div class="contact-change-notice">
                        ⚠️ 기본 담당자는 담당자가 지정되지 않은 모든 빌딩에 공통 적용됩니다
                    </div>
                    <div id="contactDefaultList">
                        <!-- 기본 담당자 목록 -->
                    </div>
                </div>
                
                <!-- S&I 담당자 탭 -->
                <div class="contact-change-panel" id="contactPanelSni" style="display:none;">
                    <div style="margin-bottom:12px;">
                        <input type="text" id="contactSniSearch" placeholder="🔍 이름 또는 이메일로 검색..." style="width:100%; padding:10px 12px; border:1px solid var(--border-color); border-radius:8px; font-size:13px;">
                    </div>
                    <div id="contactSniList">
                        <!-- S&I 담당자 목록 -->
                    </div>
                </div>
                
                <!-- 직접 입력 탭 -->
                <div class="contact-change-panel" id="contactPanelCustom" style="display:none;">
                    <div style="display:grid; gap:12px;">
                        <div>
                            <label style="font-size:12px; font-weight:500; color:var(--text-secondary); margin-bottom:4px; display:block;">담당자명 *</label>
                            <input type="text" id="customContactName" placeholder="홍길동" style="width:100%; padding:10px 12px; border:1px solid var(--border-color); border-radius:6px;">
                        </div>
                        <div>
                            <label style="font-size:12px; font-weight:500; color:var(--text-secondary); margin-bottom:4px; display:block;">연락처 *</label>
                            <input type="tel" id="customContactPhone" placeholder="010-1234-5678" style="width:100%; padding:10px 12px; border:1px solid var(--border-color); border-radius:6px;">
                        </div>
                        <div>
                            <label style="font-size:12px; font-weight:500; color:var(--text-secondary); margin-bottom:4px; display:block;">이메일</label>
                            <input type="email" id="customContactEmail" placeholder="example@company.com" style="width:100%; padding:10px 12px; border:1px solid var(--border-color); border-radius:6px;">
                        </div>
                        <button class="btn btn-secondary" onclick="addCustomContact()" style="margin-top:8px;">+ 담당자 추가</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display:flex; justify-content:space-between;">
                <button class="btn" style="color:#dc2626; border:1px solid #fecaca;" onclick="resetToDefaultContacts()">🔄 기본값으로 초기화</button>
                <div style="display:flex; gap:8px;">
                    <button class="btn btn-secondary" onclick="closeContactChangeModal()">취소</button>
                    <button class="btn btn-primary" onclick="saveContactChanges()">💾 저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 토스트 컨테이너 -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Quill 에디터 CDN -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
    
    <!-- 카카오맵 SDK -->
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1ac6eee9b1e4c2e0cc6f1d1ca1a6a559&libraries=services&autoload=false"></script>

    <!-- ★ v4.2: 기본 담당자 하드코딩 -->
    <script>
        // 기본 담당자 정보 (전역)
        window.DEFAULT_CONTACT_POINTS = [
            { name: '안준희 파트너', phone: '010-3241-5337', email: 'helper08@sni.co.kr' },
            { name: '소나무 파트너', phone: '010-7608-5142', email: 'pinetree@sni.co.kr' },
            { name: '남민준 파트너', phone: '010-4938-4313', email: 'singsong@sni.co.kr' }
        ];
        
        // 담당자 정보가 없을 때 기본값 사용하는 헬퍼 함수
        window.getContactPointsWithDefault = function(buildingContacts) {
            if (buildingContacts && buildingContacts.length > 0) {
                return buildingContacts;
            }
            return window.DEFAULT_CONTACT_POINTS;
        };
        
        // ★ v4.3: 담당자가 기본값인지 확인
        window.isDefaultContactPoints = function(contacts) {
            if (!contacts || contacts.length === 0) return true;
            if (contacts.length !== window.DEFAULT_CONTACT_POINTS.length) return false;
            
            // 이름과 이메일이 모두 같으면 기본값
            const defaultEmails = window.DEFAULT_CONTACT_POINTS.map(c => c.email).sort();
            const currentEmails = contacts.map(c => c.email).sort();
            return JSON.stringify(defaultEmails) === JSON.stringify(currentEmails);
        };
    </script>
    
    <!-- ★ v4.3: 담당자 변경 모달 JavaScript -->
    <script>
        // 담당자 변경 모달 상태
        window.contactChangeState = {
            buildingId: null,
            buildingName: '',
            tocIndex: null,
            selectedContacts: [],
            isDefault: true
        };
        
        // 담당자 변경 모달 열기
        window.openContactChangeModal = function(buildingId, buildingName, tocIndex, currentContacts) {
            window.contactChangeState = {
                buildingId: buildingId,
                buildingName: buildingName,
                tocIndex: tocIndex,
                selectedContacts: currentContacts ? [...currentContacts] : [...window.DEFAULT_CONTACT_POINTS],
                isDefault: window.isDefaultContactPoints(currentContacts)
            };
            
            document.getElementById('contactChangeBuildingName').textContent = buildingName || '빌딩명';
            
            // 탭 초기화
            switchContactChangeTab('default');
            
            // 현재 선택된 담당자 표시
            renderCurrentContacts();
            
            // 기본 담당자 목록 렌더링
            renderDefaultContactList();
            
            // S&I 담당자 목록 렌더링 (users 컬렉션에서)
            renderSniContactList();
            
            document.getElementById('contactChangeModal').style.display = 'flex';
        };
        
        // 담당자 변경 모달 닫기
        window.closeContactChangeModal = function() {
            document.getElementById('contactChangeModal').style.display = 'none';
            window.contactChangeState = {
                buildingId: null,
                buildingName: '',
                tocIndex: null,
                selectedContacts: [],
                isDefault: true
            };
        };
        
        // 탭 전환
        window.switchContactChangeTab = function(tabName) {
            // 탭 버튼 상태 변경
            document.querySelectorAll('.contact-change-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabName);
            });
            
            // 패널 표시/숨김
            document.getElementById('contactPanelDefault').style.display = tabName === 'default' ? 'block' : 'none';
            document.getElementById('contactPanelSni').style.display = tabName === 'sni' ? 'block' : 'none';
            document.getElementById('contactPanelCustom').style.display = tabName === 'custom' ? 'block' : 'none';
        };
        
        // 현재 선택된 담당자 렌더링
        window.renderCurrentContacts = function() {
            const container = document.getElementById('contactCurrentList');
            const contacts = window.contactChangeState.selectedContacts;
            
            if (!contacts || contacts.length === 0) {
                container.innerHTML = '<span style="color:var(--text-muted); font-size:12px;">선택된 담당자가 없습니다</span>';
                return;
            }
            
            container.innerHTML = contacts.map((c, idx) => `
                <div class="contact-current-chip">
                    <span>${c.name}</span>
                    <button class="remove" onclick="removeSelectedContact(${idx})">×</button>
                </div>
            `).join('');
        };
        
        // 선택된 담당자 제거
        window.removeSelectedContact = function(index) {
            window.contactChangeState.selectedContacts.splice(index, 1);
            window.contactChangeState.isDefault = false;
            renderCurrentContacts();
            renderDefaultContactList();
            renderSniContactList();
        };
        
        // 기본 담당자 목록 렌더링
        window.renderDefaultContactList = function() {
            const container = document.getElementById('contactDefaultList');
            const selectedEmails = window.contactChangeState.selectedContacts.map(c => c.email);
            
            container.innerHTML = window.DEFAULT_CONTACT_POINTS.map(contact => {
                const isSelected = selectedEmails.includes(contact.email);
                return `
                    <div class="contact-option ${isSelected ? 'selected' : ''}" onclick="toggleDefaultContact('${contact.email}')">
                        <input type="checkbox" ${isSelected ? 'checked' : ''} onclick="event.stopPropagation(); toggleDefaultContact('${contact.email}')">
                        <div class="info">
                            <div class="name">${contact.name}</div>
                            <div class="detail">${contact.phone} · ${contact.email}</div>
                        </div>
                        <span class="badge">기본</span>
                    </div>
                `;
            }).join('');
        };
        
        // 기본 담당자 토글
        window.toggleDefaultContact = function(email) {
            const contact = window.DEFAULT_CONTACT_POINTS.find(c => c.email === email);
            if (!contact) return;
            
            const idx = window.contactChangeState.selectedContacts.findIndex(c => c.email === email);
            
            if (idx >= 0) {
                // 이미 선택됨 → 제거
                window.contactChangeState.selectedContacts.splice(idx, 1);
            } else {
                // 선택 안됨 → 추가 (최대 4명)
                if (window.contactChangeState.selectedContacts.length >= 4) {
                    showToast('담당자는 최대 4명까지 선택 가능합니다', 'warning');
                    return;
                }
                window.contactChangeState.selectedContacts.push({ ...contact });
            }
            
            window.contactChangeState.isDefault = false;
            renderCurrentContacts();
            renderDefaultContactList();
            renderSniContactList();
        };
        
        // S&I 담당자 목록 렌더링
        window.renderSniContactList = function() {
            const container = document.getElementById('contactSniList');
            const selectedEmails = window.contactChangeState.selectedContacts.map(c => c.email);
            
            // users 컬렉션에서 S&I 직원 목록 가져오기
            if (typeof window.guideDataCache !== 'undefined' && window.guideDataCache.users) {
                const users = Object.values(window.guideDataCache.users).filter(u => u.role !== 'viewer');
                
                if (users.length === 0) {
                    container.innerHTML = '<div style="text-align:center; color:var(--text-muted); padding:20px;">등록된 S&I 담당자가 없습니다</div>';
                    return;
                }
                
                container.innerHTML = users.map(user => {
                    const isSelected = selectedEmails.includes(user.email);
                    const isDefault = window.DEFAULT_CONTACT_POINTS.some(d => d.email === user.email);
                    return `
                        <div class="contact-option ${isSelected ? 'selected' : ''}" onclick="toggleSniContact('${user.email}', '${user.name || ''}', '${user.phone || ''}')">
                            <input type="checkbox" ${isSelected ? 'checked' : ''} onclick="event.stopPropagation(); toggleSniContact('${user.email}', '${user.name || ''}', '${user.phone || ''}')">
                            <div class="info">
                                <div class="name">${user.name || user.email}</div>
                                <div class="detail">${user.phone || '-'} · ${user.email}</div>
                            </div>
                            ${isDefault ? '<span class="badge">기본</span>' : '<span class="badge" style="background:#d1fae5; color:#065f46;">S&I</span>'}
                        </div>
                    `;
                }).join('');
            } else {
                container.innerHTML = '<div style="text-align:center; color:var(--text-muted); padding:20px;">데이터 로딩 중...</div>';
            }
            
            // 검색 기능
            const searchInput = document.getElementById('contactSniSearch');
            if (searchInput) {
                searchInput.oninput = function() {
                    const keyword = this.value.toLowerCase();
                    container.querySelectorAll('.contact-option').forEach(opt => {
                        const text = opt.textContent.toLowerCase();
                        opt.style.display = text.includes(keyword) ? '' : 'none';
                    });
                };
            }
        };
        
        // S&I 담당자 토글
        window.toggleSniContact = function(email, name, phone) {
            const idx = window.contactChangeState.selectedContacts.findIndex(c => c.email === email);
            
            if (idx >= 0) {
                window.contactChangeState.selectedContacts.splice(idx, 1);
            } else {
                if (window.contactChangeState.selectedContacts.length >= 4) {
                    showToast('담당자는 최대 4명까지 선택 가능합니다', 'warning');
                    return;
                }
                window.contactChangeState.selectedContacts.push({ name, phone, email });
            }
            
            window.contactChangeState.isDefault = false;
            renderCurrentContacts();
            renderDefaultContactList();
            renderSniContactList();
        };
        
        // 직접 입력 담당자 추가
        window.addCustomContact = function() {
            const name = document.getElementById('customContactName').value.trim();
            const phone = document.getElementById('customContactPhone').value.trim();
            const email = document.getElementById('customContactEmail').value.trim();
            
            if (!name) {
                showToast('담당자명을 입력하세요', 'error');
                return;
            }
            if (!phone) {
                showToast('연락처를 입력하세요', 'error');
                return;
            }
            
            if (window.contactChangeState.selectedContacts.length >= 4) {
                showToast('담당자는 최대 4명까지 선택 가능합니다', 'warning');
                return;
            }
            
            // 중복 체크
            if (email && window.contactChangeState.selectedContacts.some(c => c.email === email)) {
                showToast('이미 추가된 담당자입니다', 'warning');
                return;
            }
            
            window.contactChangeState.selectedContacts.push({ name, phone, email: email || '' });
            window.contactChangeState.isDefault = false;
            
            // 입력 필드 초기화
            document.getElementById('customContactName').value = '';
            document.getElementById('customContactPhone').value = '';
            document.getElementById('customContactEmail').value = '';
            
            renderCurrentContacts();
            showToast(`${name} 담당자가 추가되었습니다`, 'success');
        };
        
        // 기본값으로 초기화
        window.resetToDefaultContacts = function() {
            if (confirm('기본 담당자로 초기화하시겠습니까?\n현재 선택된 담당자가 모두 해제됩니다.')) {
                window.contactChangeState.selectedContacts = [...window.DEFAULT_CONTACT_POINTS];
                window.contactChangeState.isDefault = true;
                renderCurrentContacts();
                renderDefaultContactList();
                renderSniContactList();
                showToast('기본 담당자로 초기화되었습니다', 'success');
            }
        };
        
        // 담당자 변경 저장
        window.saveContactChanges = function() {
            const changeState = window.contactChangeState;
            
            if (changeState.selectedContacts.length === 0) {
                showToast('최소 1명의 담당자를 선택하세요', 'error');
                return;
            }
            
            // guideState의 tocItems에서 해당 빌딩 찾아서 contactPoints 업데이트
            const guideState = window.guideState;
            if (guideState && guideState.tocItems && changeState.tocIndex !== null) {
                const item = guideState.tocItems[changeState.tocIndex];
                if (item) {
                    item.contactPoints = changeState.selectedContacts;
                    item.useDefaultContacts = changeState.isDefault;
                    
                    // 빌딩 정보 찾기
                    const building = guideState.allBuildings?.find(b => b.id === item.buildingId);
                    
                    // 편집 화면 업데이트
                    if (typeof window.renderBuildingEditor === 'function' && building) {
                        window.renderBuildingEditor(item, building);
                    }
                    
                    showToast('담당자가 변경되었습니다. 저장 버튼을 눌러 최종 반영하세요.', 'success');
                }
            } else {
                console.error('guideState 또는 tocIndex가 정의되지 않았습니다', { guideState, changeState });
                showToast('상태 오류가 발생했습니다', 'error');
            }
            
            closeContactChangeModal();
        };
        
        // 담당자 섹션 렌더링 헬퍼 (빌딩 편집 화면에서 사용)
        window.renderContactSectionWithActions = function(contacts, buildingId, buildingName, tocIndex) {
            const isDefault = window.isDefaultContactPoints(contacts);
            const displayContacts = window.getContactPointsWithDefault(contacts);
            
            return `
                <div class="preview-contact-section">
                    <div class="preview-contact-header">
                        <div class="section-title">
                            👤 Contact Point
                            ${isDefault ? '<span class="default-badge">기본값</span>' : '<span class="custom-badge">지정됨</span>'}
                        </div>
                        <div class="preview-contact-actions">
                            <button class="btn-change" onclick="openContactChangeModal('${buildingId}', '${buildingName}', ${tocIndex}, ${JSON.stringify(contacts || []).replace(/"/g, '&quot;')})">변경</button>
                            ${!isDefault ? `<button class="btn-reset" onclick="resetBuildingToDefaultContacts(${tocIndex})">해지</button>` : ''}
                        </div>
                    </div>
                    <table class="preview-contact-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${displayContacts.map(c => `
                                <tr>
                                    <td>${c.name || '-'}</td>
                                    <td>${c.phone || '-'}</td>
                                    <td>${c.email || '-'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };
        
        // 빌딩을 기본 담당자로 초기화
        window.resetBuildingToDefaultContacts = function(tocIndex) {
            if (confirm('이 빌딩의 담당자를 기본값으로 초기화하시겠습니까?')) {
                const guideState = window.guideState;
                if (guideState && guideState.tocItems) {
                    const item = guideState.tocItems[tocIndex];
                    if (item) {
                        item.contactPoints = null;
                        item.useDefaultContacts = true;
                        
                        // 빌딩 정보 찾기
                        const building = guideState.allBuildings?.find(b => b.id === item.buildingId);
                        
                        if (typeof window.renderBuildingEditor === 'function' && building) {
                            window.renderBuildingEditor(item, building);
                        }
                        
                        showToast('기본 담당자로 초기화되었습니다', 'success');
                    }
                } else {
                    console.error('guideState가 정의되지 않았습니다');
                    showToast('상태 오류가 발생했습니다', 'error');
                }
            }
        };
    </script>

    <!-- ★ v4.6: guideState 전역 노출 (담당자 변경 기능에서 사용) -->
    <script type="module">
        import { state } from './js/guide/guide-state.js';
        window.guideState = state;
        console.log('[Guide] guideState 전역 노출 완료');
    </script>

    <!-- 모듈 로드 -->
    <script type="module" src="./js/guide/guide-main.js?v=4.9"></script>
</body>
</html>
